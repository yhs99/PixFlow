<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¡¤ ëœë¤ ì±”í”¼ì–¸ ë½‘ê¸°</title>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

  <style>
    :root {
      --bg-color: #ffffff;
      --text-color: #333333;
      --border-color: #cccccc;
      --seat-bg: #f0f0f0;
      --seat-taken-bg: #d0d0d0;
      --container-bg: #f8f8f8;
      --game-status-bg: #f8f8f8;
      --nickname-form-bg: #f8f8f8;
      --champion-list-bg: #f8f8f8;
      --input-bg: #ffffff;
      --button-bg: #4CAF50;
      --button-hover-bg: #45a049;
      --button-disabled-bg: #cccccc;
      --team1-border: #ff0000;
      --team2-border: #0000ff;
      --waiting-border: #cccccc;
      --modal-bg: rgba(0, 0, 0, 0.7);
      --modal-content-bg: #ffffff;
      --win-color: #4CAF50;
      --lose-color: #f44336;
    }

    [data-theme="dark"] {
      --bg-color: #1a1a2e;
      --text-color: #ffffff;
      --border-color: #4a4a6e;
      --seat-bg: #2a2a4e;
      --seat-taken-bg: #3a3a5e;
      --container-bg: #2a2a4e;
      --game-status-bg: #1a1a2e;
      --nickname-form-bg: #1a1a2e;
      --champion-list-bg: #1a1a2e;
      --input-bg: #2a2a4e;
      --button-bg: #3a3a5e;
      --button-hover-bg: #4a4a6e;
      --button-disabled-bg: #2a2a4e;
      --team1-border: #ff5f5f;
      --team2-border: #5f5fff;
      --waiting-border: #4a4a6e;
      --modal-bg: rgba(0, 0, 0, 0.9);
      --modal-content-bg: #2a2a4e;
      --win-color: #4CAF50;
      --lose-color: #f44336;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: all 0.3s ease;
    }

    [data-theme="dark"] body {
      background-image: radial-gradient(circle at 50% 50%, #1a1a2e 0%, #0a0a1e 100%);
    }

    .container { 
      max-width: 1000px; 
      margin: 20px auto; 
      padding: 20px;
      background-color: var(--container-bg);
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    [data-theme="dark"] .container {
      box-shadow: 0 0 20px rgba(255,255,255,0.05);
    }

    .theme-switch {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-color);
      padding: 10px;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .theme-switch:hover {
      background-color: rgba(255,255,255,0.1);
    }

    .seat {
      width: 100%; 
      height: 80px; 
      margin: 5px 0;
      display: flex; 
      flex-direction: column; 
      justify-content: center; 
      align-items: center;
      background: var(--seat-bg); 
      cursor: pointer; 
      user-select: none;
      border-radius: 5px;
      position: relative;
      transition: all 0.3s ease;
    }

    .seat.taken { 
      background: var(--seat-taken-bg);
    }

    .seat.team1 { 
      border: 2px solid var(--team1-border);
    }

    .seat.team2 { 
      border: 2px solid var(--team2-border);
    }

    .seat.waiting { 
      border: 2px solid var(--waiting-border);
    }

    [data-theme="dark"] .seat {
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    [data-theme="dark"] .seat:hover {
      background: var(--seat-taken-bg);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    [data-theme="dark"] .seat.taken:hover {
      background: var(--button-bg);
    }

    [data-theme="dark"] .seat .select-btn {
      background: var(--button-bg);
      border: 1px solid var(--border-color);
      color: var(--text-color);
    }

    [data-theme="dark"] .seat .select-btn:hover {
      background: var(--button-hover-bg);
    }

    [data-theme="dark"] .seat div {
      color: var(--text-color);
    }

    [data-theme="dark"] #team1Seats,
    [data-theme="dark"] #team2Seats,
    [data-theme="dark"] #waitingSeats {
      background: var(--container-bg);
      border-radius: 5px;
      padding: 10px;
      margin: 5px 0;
    }

    #team1Seats, #team2Seats, #waitingSeats {
      background: var(--container-bg);
      border-radius: 5px;
      padding: 10px;
      margin: 5px 0;
      transition: all 0.3s ease;
    }

    .team {
      border-color: var(--border-color);
      background-color: var(--container-bg);
    }

    .waiting-room {
      border-color: var(--border-color);
      background-color: var(--container-bg);
    }

    [data-theme="dark"] .team,
    [data-theme="dark"] .waiting-room {
      border: 1px solid var(--border-color);
      background-color: rgba(42, 42, 78, 0.8);
    }

    [data-theme="dark"] .controls button {
      background-color: #3a3a5e;
      color: white;
      border: 1px solid var(--border-color);
    }

    [data-theme="dark"] .controls button:disabled {
      background-color: #2a2a4e;
      color: #666;
    }

    [data-theme="dark"] .champion-display {
      border: 2px solid var(--border-color);
    }

    .room-form { margin-bottom: 20px; }
    .teams-container { 
      display: flex; 
      justify-content: space-between; 
      margin: 20px 0;
      gap: 20px;
      flex-wrap: wrap;
    }
    .team { 
      width: 30%; 
      padding: 10px; 
      border: 1px solid #ccc; 
      border-radius: 5px;
      flex: 1;
      min-width: 200px;
    }
    
    /* ë°´ ì±”í”¼ì–¸ ì„¹ì…˜ì´ ìˆ¨ê²¨ì¡Œì„ ë•Œ íŒ€ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
    .teams-container.no-ban .team {
      width: 45%;
      flex: 0 0 45%;
    }
    
    .team h3 {
      text-align: left;
    }
    .team:nth-child(2) h3 {
      text-align: right;
    }
    .team-ban-slots {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      gap: 5px;
    }
    .ban-slot {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: 2px solid #f44336;
      background-color: var(--seat-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .ban-slot img {
      width: 100%; 
      height: 100%;
      object-fit: cover;
      opacity: 0.7;
    }
    .ban-slot.empty {
      position: relative;
    }
    .ban-slot.empty::after {
      content: "";
      position: absolute;
      width: 70%;
      height: 2px;
      background-color: #f44336;
      transform: rotate(45deg);
    }
    .ban-slot.empty::before {
      content: "";
      position: absolute;
      width: 70%;
      height: 2px;
      background-color: #f44336;
      transform: rotate(-45deg);
    }
    .waiting-room { 
      width: 99%; 
      padding: 10px; 
      border: 1px solid #ccc; 
      border-radius: 5px; 
      margin: 20px 0;
      background: #f8f8f8;
    }
    .waiting-room h3 {
      margin-top: 0;
      color: #333;
    }
    #waitingSeats {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin-top: 10px;
    }
    .seat .select-btn {
      position: absolute;
      bottom: 5px;
      left: 50%;
      transform: translateX(-50%);
      padding: 2px 8px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
      display: none;
    }
    .seat:not(.taken):hover .select-btn {
      display: block;
    }
    .seat .player-info {
      text-align: center;
      font-size: 12px;
      display: flex;
      flex-direction: row;
      height: 100%;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 15px;
    }
    .seat.team1 .player-info {
      flex-direction: row;
    }
    .seat.team2 .player-info {
      flex-direction: row-reverse;
    }
    .seat .player-name {
      font-weight: bold;
      flex: 1;
      text-align: center;
      font-size: 16px;
      margin: 0 10px;
    }
    .seat .player-name.self {
      color: #4CAF50; /* ì´ˆë¡ìƒ‰ */
      font-weight: bold;
    }
    .seat .player-name.host {
      color: #ff0000; /* ë¹¨ê°„ìƒ‰ */
      font-weight: bold;
    }
    .seat .champion-display { 
      font-weight: bold; 
      color: #333;
      margin: 5px 0;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 5px;
    }
    .seat .champion-display img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .seat .champion-display.unknown {
      background-color: var(--seat-bg);
      color: var(--text-color);
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .seat .reroll-count { 
      color: #666; 
      font-size: 0.8em;
      margin-top: 5px;
    }
    .seat .reroll-btn {
      margin-top: auto;
      padding: 2px 8px;
      background: #2196F3;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
    }
    .seat .reroll-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .controls {
      margin: 20px 0;
      text-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    .controls button { 
      margin: 0 10px; 
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .controls button:disabled {
      background-color: var(--button-disabled-bg);
      cursor: not-allowed;
      opacity: 0.7;
    }
    #rerollBtn {
      background-color: #2196F3;
      color: white;
      border: none;
    }
    #rerollBtn:not(:disabled):hover {
      background-color: #1976D2;
    }
    .reroll-count-display {
      color: #666;
      font-size: 14px;
      margin-left: 5px;
    }
    .room-list {
      margin: 20px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 10px;
    }
    .room-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid #eee;
    }
    .room-item:last-child {
      border-bottom: none;
    }
    .room-info {
      flex: 1;
    }
    .room-actions {
      display: flex;
      gap: 10px;
    }
    .room-actions button {
      padding: 5px 10px;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    .join-btn {
      background: #4CAF50;
      color: white;
    }
    .create-room-form {
      margin: 20px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      text-align: center;
    }
    .create-room-form input {
      margin: 10px;
      padding: 5px;
    }
    .create-room-form button {
      padding: 5px 15px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    .game-status {
      text-align: center;
      margin-bottom: 20px;
      padding: 10px;
      background: var(--game-status-bg);
      border-radius: 5px;
      border: 1px solid var(--border-color);
    }
    .game-status h2 {
      margin: 0;
      color: #333;
      font-size: 1.2em;
    }
    .countdown {
      font-size: 1.5em;
      font-weight: bold;
      color: #ff0000;
      margin: 10px 0;
    }

    /* ìˆ˜ì •: game-statusë¥¼ ìƒë‹¨ì— ê³ ì • */
    .fixed-game-status {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      background: var(--game-status-bg);
      border-bottom: 1px solid var(--border-color);
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 10px;
      text-align: center;
      transition: all 0.3s ease;
      width: 100%;
      max-width: 1020px;
      margin: 0 auto;
    }

    /* ë‹¤í¬ ëª¨ë“œì—ì„œì˜ ê³ ì • ìƒíƒœë°” ìŠ¤íƒ€ì¼ */
    [data-theme="dark"] .fixed-game-status {
      background: var(--container-bg);
      border-color: var(--border-color);
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    /* ê³ ì • ìƒíƒœë°”ê°€ ì ìš©ë  ë•Œ ì½˜í…ì¸  ì—¬ë°± */
    .status-padding {
      padding-top: 70px;
    }
    
    /* ëª¨ë°”ì¼ í™”ë©´ì—ì„œì˜ ê³ ì • ìƒíƒœë°” ìŠ¤íƒ€ì¼ */
    @media (max-width: 768px) {
      .fixed-game-status {
        padding: 5px;
        font-size: 0.9em;
      }
      
      .fixed-game-status h2 {
        font-size: 1em;
      }
      
      .status-padding {
        padding-top: 60px;
      }
    }

    .nickname-form {
      text-align: center;
      margin-bottom: 20px;
      padding: 10px;
      background: var(--nickname-form-bg);
      border-radius: 5px;
      display: flex;
      justify-content: center;
      gap: 10px;
      border: 1px solid var(--border-color);
    }
    .nickname-form input {
      padding: 5px 10px;
      border: 1px solid var(--border-color);
      border-radius: 3px;
      width: 200px;
      background: var(--input-bg);
      color: var(--text-color);
    }
    .nickname-form button,
    .controls button {
      padding: 5px 15px;
      background: var(--button-bg);
      color: white;
      border: 1px solid var(--border-color);
      border-radius: 3px;
      cursor: pointer;
    }
    .nickname-form button:hover,
    .controls button:hover {
      background: var(--button-hover-bg);
    }
    .nickname-form button:disabled,
    .controls button:disabled {
      background: var(--button-disabled-bg);
      color: #666;
      cursor: not-allowed;
    }
    .champion-list {
      margin: 20px 0;
      padding: 10px;
      background: var(--champion-list-bg);
      border-radius: 5px;
      border: 1px solid var(--border-color);
    }
    .champion-list h3 {
      margin: 0 0 10px 0;
      color: var(--text-color);
    }
    .champion-list-items {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(48px, 1fr));
      gap: 10px;
      padding: 5px;
      min-height: 60px;
      width: 100%;
    }
    
    .empty-champion-list {
      grid-column: 1 / -1;
      text-align: center;
      padding: 10px;
      color: var(--text-color);
      font-style: italic;
      width: 100%;
      display: block;
    }
    
    .champion-item {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      overflow: hidden;
      cursor: pointer;
      border: 2px solid var(--border-color);
      transition: all 0.3s ease;
      background: var(--seat-bg);
    }
    .champion-item:hover {
      border-color: var(--button-hover-bg);
      background: var(--seat-taken-bg);
      transform: scale(1.1);
    }
    .champion-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    [data-theme="dark"] .team h3,
    [data-theme="dark"] .waiting-room h3,
    [data-theme="dark"] .champion-list h3 {
      color: #8a8aae;
    }

    /* ê³µì§€ì‚¬í•­ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .notice-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--modal-bg);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .notice-modal-content {
      background-color: var(--modal-content-bg);
      color: var(--text-color);
      padding: 30px;
      border-radius: 10px;
      text-align: left;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .notice-title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 20px;
      text-align: center;
      color: var(--button-bg);
    }

    .notice-content {
      margin-bottom: 20px;
    }

    .notice-update-item {
      margin-bottom: 15px;
      padding-left: 20px;
      position: relative;
    }

    .notice-update-item:before {
      content: "â€¢";
      position: absolute;
      left: 0;
      color: var(--button-bg);
    }

    .notice-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    .notice-buttons button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .notice-close {
      background-color: var(--button-bg);
      color: white;
    }

    .notice-dont-show {
      background-color: var(--seat-bg);
      color: var(--text-color);
    }

    .notice-buttons button:hover {
      opacity: 0.9;
      transform: scale(1.05);
    }

    /* í”Œë ˆì´ì–´ í†µê³„ ìŠ¤íƒ€ì¼ */
    .player-stats {
      font-size: 11px;
      margin-top: 5px;
      display: flex;
      gap: 5px;
      justify-content: center;
      background-color: rgba(0, 0, 0, 0.05);
      border-radius: 10px;
      padding: 2px 5px;
      margin: 3px auto;
      max-width: fit-content;
    }

    [data-theme="dark"] .player-stats {
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    .player-stats .win {
      color: var(--win-color);
      font-weight: bold;
    }
    
    .player-stats .lose {
      color: var(--lose-color);
      font-weight: bold;
    }
    
    .player-stats .winrate {
      color: var(--text-color);
      opacity: 0.8;
    }

    .player-name {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .banned-champions {
      width: 30%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      flex: 1;
      min-width: 200px;
      background: var(--container-bg);
      transition: all 0.3s ease;
    }
    
    .banned-champions.ban-mode {
      width: 90%;
      max-width: 800px;
      margin: 0 auto;
    }
    
    .banned-champions h3 {
      text-align: center;
      margin-top: 0;
      color: var(--text-color);
    }
    
    .banned-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(48px, 1fr));
      gap: 10px;
      padding: 5px;
      min-height: 60px;
    }
    
    .ban-timer-display {
      font-size: 24px;
      font-weight: bold;
      color: #f44336;
      text-align: center;
      margin: 10px 0;
      display: none;
    }
    
    .ban-phase-controls {
      display: none;
      margin-top: 15px;
    }
    
    .ban-confirm-btn {
      padding: 10px 20px;
      background-color: #f44336;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      display: block;
      margin: 10px auto;
      transition: all 0.3s ease;
    }
    
    .ban-confirm-btn:hover {
      background-color: #d32f2f;
    }
    
    .ban-confirm-btn:disabled {
      background-color: var(--button-disabled-bg);
      cursor: not-allowed;
    }
    
    .champion-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      margin-top: 15px;
      max-height: 300px;
      overflow-y: auto;
      padding: 5px;
    }
    
    .champion-item {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      overflow: hidden;
      cursor: pointer;
      border: 2px solid var(--border-color);
      transition: all 0.3s ease;
      margin: 0 auto;
      position: relative;
    }
    
    .champion-item:hover {
      transform: scale(1.1);
      border-color: #f44336;
    }
    
    .champion-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .champion-item.banned {
      opacity: 0.5;
      position: relative;
    }
    
    .champion-item.banned::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent 45%, #f44336 45%, #f44336 55%, transparent 55%);
    }
    
    .champion-item.selected {
      border-color: #f44336;
      border-width: 3px;
      transform: scale(1.1);
    }
    
    .ban-search-input {
      width: 100%;
      padding: 8px;
      border: 1px solid var(--border-color);
      border-radius: 5px;
      background: var(--input-bg);
      color: var(--text-color);
      margin-bottom: 10px;
    }
    
    .player-ban-status {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 10px 0;
      display: none;
    }
    
    .player-ban-item {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 5px 10px;
      border-radius: 15px;
      background-color: var(--seat-bg);
      font-size: 12px;
    }
    
    .player-ban-item.completed {
      background-color: #4CAF50;
      color: white;
    }
    
    .player-ban-item.pending {
      background-color: #ff9800;
      color: white;
    }
    
    .player-ban-image {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      overflow: hidden;
    }
    
    .player-ban-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .banned-champion {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid #f44336;
      margin: 0 auto;
      position: relative;
    }
    .banned-champion img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.7;
    }
    .banned-champion::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent 45%, #f44336 45%, #f44336 55%, transparent 55%);
    }
    /* ê²Œì„ ëª¨ë“œ ì„ íƒ ëª¨ë‹¬ */
    .mode-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--modal-bg);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .mode-modal-content {
      background-color: var(--modal-content-bg);
      color: var(--text-color);
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      max-width: 500px;
      width: 90%;
    }
    .mode-title {
      font-size: 24px;
      margin-bottom: 20px;
      color: var(--button-bg);
    }
    .mode-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }
    .mode-btn {
      padding: 15px 25px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      font-size: 16px;
      transition: all 0.3s ease;
    }
    .mode-btn:hover {
      transform: scale(1.05);
    }
    .normal-mode-btn {
      background-color: var(--button-bg);
      color: white;
    }
    .ban-mode-btn {
      background-color: #f44336;
      color: white;
    }

    .ban-team-header {
      font-weight: bold;
      font-size: 16px;
      margin: 15px 0 8px 0;
      padding: 5px;
      background-color: var(--team1-border);
      color: white;
      border-radius: 5px;
      text-align: center;
    }
    
    .ban-team-header.enemy {
      background-color: var(--team2-border);
    }
    
    .player-ban-status {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 10px 0;
    }
    
    .player-ban-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 8px 12px;
      border-radius: 8px;
      background-color: var(--seat-bg);
      border-left: 4px solid transparent;
    }
    
    .player-ban-item.completed {
      background-color: var(--seat-taken-bg);
      border-left: 4px solid #4CAF50;
    }
    
    .player-ban-item.selecting {
      background-color: var(--seat-bg);
      border-left: 4px solid #ff9800;
      animation: pulse 1.5s infinite;
    }
    
    .player-ban-item.enemy {
      border-left: 4px solid var(--team2-border);
    }
    
    @keyframes pulse {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }
    
    .selecting-status {
      font-style: italic;
      color: #ff9800;
      font-size: 14px;
    }
    
    .empty-enemy-ban {
      padding: 10px;
      text-align: center;
      font-style: italic;
      color: var(--text-color);
      opacity: 0.7;
    }
    
    .player-ban-image {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      overflow: hidden;
      border: 2px solid #f44336;
    }

    /* íŒ€ì›ì´ ì„ íƒ ì¤‘ì¸ ì±”í”¼ì–¸ì„ í‘œì‹œí•˜ëŠ” ìŠ¤íƒ€ì¼ */
    .champion-item.selected-by-team {
      border: 2px dotted #ffcc00;
      opacity: 0.8;
      position: relative;
    }
    
    .champion-item.selected-by-team::before {
      content: 'íŒ€ì› ì„ íƒ ì¤‘';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      background-color: rgba(255, 204, 0, 0.7);
      color: #000;
      font-size: 10px;
      text-align: center;
      padding: 2px 0;
    }

    /* ë°´ ë‹¨ê³„ì—ì„œ ìƒëŒ€íŒ€ì˜ ë°´ ìŠ¬ë¡¯ ìˆ¨ê¸°ê¸° - ë” ëª…í™•í•œ ì„ íƒì ì‚¬ìš© */
    .ban-mode .team:not(.my-team) .team-ban-slots .ban-slot {
      background-color: rgba(80, 80, 80, 0.3);
      position: relative;
    }
    
    .ban-mode .team:not(.my-team) .team-ban-slots .ban-slot img {
      display: none;
    }
    
    .ban-mode .team:not(.my-team) .team-ban-slots .ban-slot:not(.empty)::after {
      content: '?';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 20px;
      color: #888;
      font-weight: bold;
    }

    /* ìë¦¬ ì´ë™ ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes seatMove {
      0% { 
        transform: scale(0.8);
        opacity: 0.5;
      }
      50% {
        transform: scale(1.1);
        background-color: rgba(74, 220, 162, 0.6);
      }
      100% { 
        transform: scale(1);
        opacity: 1;
      }
    }

    .seat.moving {
      animation: seatMove 0.8s ease-in-out;
    }
  </style>
</head>
<body>
  <% const currentPath = '/lol' %>
  <%- include('header.ejs', { currentPath }) %>
  <div class="container">
    <button class="theme-switch" id="themeSwitch">ğŸŒ</button>
    <div id="gameRoom" style="display: none;">
      <div class="game-status" id="gameStatus">
        <h2 id="gameStatusMessage">ê²Œì„ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. íŒ€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</h2>
        <div id="countdown" class="countdown" style="display: none;"></div>
      </div>
      <div class="content-wrapper" id="contentWrapper">
      <div class="champion-list">
        <h3>íŒ€ ì „ìš© ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ (í´ë¦­í•˜ì—¬ êµì²´)</h3>
        <div class="champion-list-items" id="championList"></div>
      </div>
      <div class="teams-container">
        <div class="team">
          <h3>íŒ€ 1</h3>
            <div class="team-ban-slots">
              <div class="ban-slot empty"></div>
              <div class="ban-slot empty"></div>
              <div class="ban-slot empty"></div>
              <div class="ban-slot empty"></div>
              <div class="ban-slot empty"></div>
            </div>
          <div id="team1Seats"></div>
        </div>
          
          <div class="banned-champions" id="bannedChampionsSection">
            <h3 id="bannedChampionsTitle">ë°´ ì±”í”¼ì–¸</h3>
            <div id="banTimerDisplay" class="ban-timer-display"></div>
            <div id="playerBanStatus" class="player-ban-status"></div>
            <div id="banPhaseControls" class="ban-phase-controls">
              <input type="text" id="banSearchInput" class="ban-search-input" placeholder="ì±”í”¼ì–¸ ì´ë¦„ ê²€ìƒ‰...">
              <div id="championGrid" class="champion-grid"></div>
              <button id="banConfirmBtn" class="ban-confirm-btn" disabled>ë°´ í™•ì •</button>
            </div>
            <div id="bannedChampions" class="banned-list"></div>
          </div>
          
        <div class="team">
          <h3>íŒ€ 2</h3>
            <div class="team-ban-slots">
              <div class="ban-slot empty"></div>
              <div class="ban-slot empty"></div>
              <div class="ban-slot empty"></div>
              <div class="ban-slot empty"></div>
              <div class="ban-slot empty"></div>
            </div>
          <div id="team2Seats"></div>
        </div>
      </div>
      <div class="controls">
        <button id="startGameBtn" disabled>ê²Œì„ ì‹œì‘</button>
        <button id="resetGameBtn" disabled>ê²Œì„ ì´ˆê¸°í™”</button>
        <button id="resetRoomBtn" disabled>ë°© ì´ˆê¸°í™”</button>
        <button id="rerollBtn" disabled>ë¦¬ë¡¤</button>
        <button id="randomAssignBtn" disabled>ëœë¤ ë°°ì •</button>
      </div>
      <div class="waiting-room">
        <h3>ëŒ€ê¸°ì‹¤</h3>
        <div id="waitingSeats"></div>
        </div>
        <!-- ë‹‰ë„¤ì„ ë³€ê²½ í¼ì„ ëŒ€ê¸°ì‹¤ ì•„ë˜ë¡œ ì´ë™ -->
        <div class="nickname-form">
          <input type="text" id="nicknameInput" placeholder="ë³€ê²½í•  ë‹‰ë„¤ì„ ì…ë ¥">
          <button onclick="changeNickname()">ë‹‰ë„¤ì„ ë³€ê²½</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ê²Œì„ ëª¨ë“œ ì„ íƒ ëª¨ë‹¬ -->
  <div id="modeSelectModal" class="mode-modal" style="display: none;">
    <div class="mode-modal-content">
      <div class="mode-title">ê²Œì„ ëª¨ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</div>
      <div class="mode-description">
        <p><b>ì¼ë°˜ ëª¨ë“œ:</b> ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ ê²Œì„ì´ ì§„í–‰ë©ë‹ˆë‹¤.</p>
        <p><b>ë°´ ëª¨ë“œ:</b> ê²Œì„ ì‹œì‘ ì „ ê° í”Œë ˆì´ì–´ê°€ ì±”í”¼ì–¸ì„ ë°´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      </div>
      <div class="mode-buttons">
        <button id="normalModeBtn" class="mode-btn normal-mode-btn">ì¼ë°˜ ëª¨ë“œ</button>
        <button id="banModeBtn" class="mode-btn ban-mode-btn">ë°´ ëª¨ë“œ</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.socket.io/4.7.1/socket.io.min.js"></script>
  <script>
    // ì„œë²„ì—ì„œ ì „ë‹¬ë°›ì€ champions ë°°ì—´ì„ ì „ì—­ ë³€ìˆ˜ë¡œ ì •ì˜
    const champions = JSON.parse('<%- JSON.stringify(champions || []) %>');
    
    // SharedWorker ìƒì„± ë° ì†Œì¼“ ì—°ê²° ê´€ë¦¬
    let socketWorker;
    let socketPort;
    let socket = {
      id: null,
      emit: function(event, data) {
        socketPort.postMessage({ type: 'emit', event, data });
      },
      on: function() {},  // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” ì•„ë˜ì—ì„œ ì²˜ë¦¬
    };

    // SharedWorker ì´ˆê¸°í™”
    function initSocketWorker() {
      try {
        socketWorker = new SharedWorker('/socket-worker.js');
        socketPort = socketWorker.port;

        // ì›Œì»¤ë¡œë¶€í„°ì˜ ë©”ì‹œì§€ ì²˜ë¦¬
        socketPort.onmessage = function(e) {
          const message = e.data;
          
          if (message.type === 'socket_event') {
            const event = message.event;
            const data = message.data;

            // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í˜¸ì¶œ
            const handlers = eventHandlers[event] || [];
            handlers.forEach(handler => handler(data));

            // ì†Œì¼“ ID ì—…ë°ì´íŠ¸
            if (event === 'connect') {
              socket.id = data;
              console.log('ì„œë²„ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤. ì†Œì¼“ ID:', socket.id);
              
              // ì†Œì¼“ IDë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
              const prevSocketId = localStorage.getItem('socketId');
              localStorage.setItem('socketId', socket.id);
              
              // ì´ì „ì— ì €ì¥ëœ í†µê³„ ì •ë³´ê°€ ìˆìœ¼ë©´ ì„œë²„ì— ì „ì†¡
              const savedStats = localStorage.getItem('playerStats1');
              if (savedStats) {
                const stats = JSON.parse(savedStats);
                // ì†Œì¼“ IDê°€ ë³€ê²½ëœ ê²½ìš°(ì¬ì ‘ì†) ê¸°ì¡´ í†µê³„ ì •ë³´ë¥¼ ì„œë²„ì— ì „ì†¡
                if (prevSocketId !== socket.id) {
                  console.log('ì¬ì ‘ì† ê°ì§€: í†µê³„ ì •ë³´ ì „ì†¡');
                  
                  // ì €ì¥ëœ ì¢Œì„ ì •ë³´ í™•ì¸
                  const seatInfo = getSeatInfo();
                  if (seatInfo) {
                    console.log('ì €ì¥ëœ ì¢Œì„ ì •ë³´:', seatInfo);
                    stats.seatInfo = seatInfo; // ì¢Œì„ ì •ë³´ ì¶”ê°€
                    
                    // ì¬ì ‘ì† ì‹œ ì¢Œì„ ì •ë³´ê°€ ìˆì„ ë•Œ í† ìŠ¤íŠ¸ ì•Œë¦¼ í‘œì‹œ
                    Toastify({
                      text: `ì¬ì ‘ì† ê°ì§€: ${getTeamDisplayName(seatInfo.team)} ${seatInfo.index + 1}ë²ˆ ìë¦¬ë¡œ ìë™ ì ‘ì†í•©ë‹ˆë‹¤.`,
                      duration: 3000,
                      gravity: "top",
                      position: "center",
                      style: {
                        background: "linear-gradient(to right, #00b09b, #96c93d)",
                        color: "white",
                        fontWeight: "bold",
                        fontSize: "14px",
                        padding: "12px",
                        borderRadius: "5px"
                      }
                    }).showToast();
                  } else {
                    // ì¢Œì„ ì •ë³´ ì—†ì´ ì¬ì ‘ì†í•  ë•Œ í† ìŠ¤íŠ¸ ì•Œë¦¼
                    Toastify({
                      text: "ì¬ì ‘ì† ê°ì§€: ëŒ€ê¸°ì‹¤ì— ë°°ì¹˜ë©ë‹ˆë‹¤.",
                      duration: 3000,
                      gravity: "top",
                      position: "center",
                      style: {
                        background: "linear-gradient(to right, #3498db, #2980b9)",
                        color: "white",
                        fontWeight: "bold",
                        fontSize: "14px",
                        padding: "12px",
                        borderRadius: "5px"
                      }
                    }).showToast();
                  }
                  
                  socket.emit('reconnect-player', stats);
                }
              }
              
              // ì´ë¯¸ ë°© ìƒì„± ì¤‘ì´ ì•„ë‹ ë•Œë§Œ ë°© ìƒíƒœ ì²´í¬
              if (!isCreatingRoom && !hasJoined) {
                socket.emit('check-room');
              }
            }
          }
        };

        // ì›Œì»¤ ì´ˆê¸°í™” ë©”ì‹œì§€ ì „ì†¡
        socketPort.postMessage({ type: 'init' });
        socketPort.start();
      } catch (error) {
        console.error('SharedWorker ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
        alert('ë¸Œë¼ìš°ì €ê°€ ì§€ì›í•˜ì§€ ì•Šì•„ ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í¬ë¡¬ ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
      }
    }

    // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì €ì¥ì†Œ
    const eventHandlers = {};

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ í•¨ìˆ˜ ì¬ì •ì˜
    socket.on = function(event, handler) {
      if (!eventHandlers[event]) {
        eventHandlers[event] = [];
      }
      eventHandlers[event].push(handler);
    };

    // SharedWorker ì´ˆê¸°í™” ì‹¤í–‰
    initSocketWorker();

    // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
    window.addEventListener('unload', () => {
      if (socketPort) {
        socketPort.close();
      }
    });
    
    // í•œê¸€ ì±”í”¼ì–¸ ì´ë¦„ ë§¤í•‘
    const koreanChampionNames = {
      'Aatrox': 'ì•„íŠ¸ë¡ìŠ¤',
      'Ahri': 'ì•„ë¦¬',
      'Akali': 'ì•„ì¹¼ë¦¬',
      'Akshan': 'ì•„í¬ìƒ¨',
      'Alistar': 'ì•Œë¦¬ìŠ¤íƒ€',
      'Amumu': 'ì•„ë¬´ë¬´',
      'Anivia': 'ì• ë‹ˆë¹„ì•„',
      'Annie': 'ì• ë‹ˆ',
      'Aphelios': 'ì•„í ë¦¬ì˜¤ìŠ¤',
      'Ashe': 'ì• ì‰¬',
      'AurelionSol': 'ì•„ìš°ë ë¦¬ì˜¨ ì†”',
      'Azir': 'ì•„ì§€ë¥´',
      'Bard': 'ë°”ë“œ',
      'Belveth': 'ë²¨ë² ìŠ¤',
      'Blitzcrank': 'ë¸”ë¦¬ì¸ í¬ë­í¬',
      'Brand': 'ë¸Œëœë“œ',
      'Braum': 'ë¸Œë¼ì›€',
      'Briar': 'ë¸Œë¼ì´ì–´',
      'Caitlyn': 'ì¼€ì´í‹€ë¦°',
      'Camille': 'ì¹´ë°€',
      'Cassiopeia': 'ì¹´ì‹œì˜¤í˜ì•„',
      'Chogath': 'ì´ˆê°€ìŠ¤',
      'Corki': 'ì½”ë¥´í‚¤',
      'Darius': 'ë‹¤ë¦¬ìš°ìŠ¤',
      'Diana': 'ë‹¤ì´ì• ë‚˜',
      'Draven': 'ë“œë ˆì´ë¸',
      'DrMundo': 'ë¬¸ë„ ë°•ì‚¬',
      'Ekko': 'ì—ì½”',
      'Elise': 'ì—˜ë¦¬ìŠ¤',
      'Evelynn': 'ì´ë¸”ë¦°',
      'Ezreal': 'ì´ì¦ˆë¦¬ì–¼',
      'Fiddlesticks': 'í”¼ë“¤ìŠ¤í‹±',
      'Fiora': 'í”¼ì˜¤ë¼',
      'Fizz': 'í”¼ì¦ˆ',
      'Galio': 'ê°ˆë¦¬ì˜¤',
      'Gangplank': 'ê°±í”Œë­í¬',
      'Garen': 'ê°€ë Œ',
      'Gnar': 'ë‚˜ë¥´',
      'Gragas': 'ê·¸ë¼ê°€ìŠ¤',
      'Graves': 'ê·¸ë ˆì´ë¸Œì¦ˆ',
      'Gwen': 'ê·¸ì›¬',
      'Hecarim': 'í—¤ì¹´ë¦¼',
      'Heimerdinger': 'í•˜ì´ë¨¸ë”©ê±°',
      'Illaoi': 'ì¼ë¼ì˜¤ì´',
      'Irelia': 'ì´ë ë¦¬ì•„',
      'Ivern': 'ì•„ì´ë²ˆ',
      'Janna': 'ì”ë‚˜',
      'JarvanIV': 'ìë¥´ë°˜ 4ì„¸',
      'Jax': 'ì­ìŠ¤',
      'Jayce': 'ì œì´ìŠ¤',
      'Jhin': 'ì§„',
      'Jinx': 'ì§•í¬ìŠ¤',
      'Kaisa': 'ì¹´ì´ì‚¬',
      'Kalista': 'ì¹¼ë¦¬ìŠ¤íƒ€',
      'Karma': 'ì¹´ë¥´ë§ˆ',
      'Karthus': 'ì¹´ì„œìŠ¤',
      'Kassadin': 'ì¹´ì‚¬ë”˜',
      'Katarina': 'ì¹´íƒ€ë¦¬ë‚˜',
      'Kayle': 'ì¼€ì¼',
      'Kayn': 'ì¼€ì¸',
      'Kennen': 'ì¼€ë„¨',
      'Khazix': 'ì¹´ì§ìŠ¤',
      'Kindred': 'í‚¨ë“œë ˆë“œ',
      'Kled': 'í´ë ˆë“œ',
      'KogMaw': 'ì½”ê·¸ëª¨',
      'KSante': 'í¬ì‚°í…Œ',
      'Leblanc': 'ë¥´ë¸”ë‘',
      'LeeSin': 'ë¦¬ ì‹ ',
      'Leona': 'ë ˆì˜¤ë‚˜',
      'Lillia': 'ë¦´ë¦¬ì•„',
      'Lissandra': 'ë¦¬ì‚°ë“œë¼',
      'Lucian': 'ë£¨ì‹œì•ˆ',
      'Lulu': 'ë£°ë£¨',
      'Lux': 'ëŸ­ìŠ¤',
      'Malphite': 'ë§íŒŒì´íŠ¸',
      'Malzahar': 'ë§ìí•˜',
      'Maokai': 'ë§ˆì˜¤ì¹´ì´',
      'MasterYi': 'ë§ˆìŠ¤í„° ì´',
      'Milio': 'ë°€ë¦¬ì˜¤',
      'MissFortune': 'ë¯¸ìŠ¤ í¬ì¸ˆ',
      'Mordekaiser': 'ëª¨ë°ì¹´ì´ì €',
      'Morgana': 'ëª¨ë¥´ê°€ë‚˜',
      'Naafiri': 'ë‚˜í”¼ë¦¬',
      'Nami': 'ë‚˜ë¯¸',
      'Nasus': 'ë‚˜ì„œìŠ¤',
      'Nautilus': 'ë…¸í‹¸ëŸ¬ìŠ¤',
      'Neeko': 'ë‹ˆì½”',
      'Nidalee': 'ë‹ˆë‹¬ë¦¬',
      'Nilah': 'ë‹ë¼',
      'Nocturne': 'ë…¹í„´',
      'Nunu': 'ëˆ„ëˆ„ì™€ ìœŒëŸ¼í”„',
      'Olaf': 'ì˜¬ë¼í”„',
      'Orianna': 'ì˜¤ë¦¬ì•„ë‚˜',
      'Ornn': 'ì˜¤ë¥¸',
      'Pantheon': 'íŒí…Œì˜¨',
      'Poppy': 'ë½€ì‚',
      'Pyke': 'íŒŒì´í¬',
      'Qiyana': 'í‚¤ì´ë‚˜',
      'Quinn': 'í€¸',
      'Rakan': 'ë¼ì¹¸',
      'Rammus': 'ëŒë¨¸ìŠ¤',
      'RekSai': 'ë ‰ì‚¬ì´',
      'Rell': 'ë ',
      'RenataGlasc': 'ë ˆë‚˜íƒ€ ê¸€ë¼ìŠ¤í¬',
      'Renekton': 'ë ˆë„¥í†¤',
      'Rengar': 'ë ê°€',
      'Riven': 'ë¦¬ë¸',
      'Rumble': 'ëŸ¼ë¸”',
      'Ryze': 'ë¼ì´ì¦ˆ',
      'Samira': 'ì‚¬ë¯¸ë¼',
      'Sejuani': 'ì„¸ì£¼ì•„ë‹ˆ',
      'Senna': 'ì„¸ë‚˜',
      'Seraphine': 'ì„¸ë¼í•€',
      'Sett': 'ì„¸íŠ¸',
      'Shaco': 'ìƒ¤ì½”',
      'Shen': 'ì‰”',
      'Shyvana': 'ì‰¬ë°”ë‚˜',
      'Singed': 'ì‹ ì§€ë“œ',
      'Sion': 'ì‚¬ì´ì˜¨',
      'Sivir': 'ì‹œë¹„ë¥´',
      'Skarner': 'ìŠ¤ì¹´ë„ˆ',
      'Sona': 'ì†Œë‚˜',
      'Soraka': 'ì†Œë¼ì¹´',
      'Swain': 'ìŠ¤ì›¨ì¸',
      'Sylas': 'ì‚¬ì¼ëŸ¬ìŠ¤',
      'Syndra': 'ì‹ ë“œë¼',
      'TahmKench': 'íƒ ì¼„ì¹˜',
      'Taliyah': 'íƒˆë¦¬ì•¼',
      'Talon': 'íƒˆë¡ ',
      'Taric': 'íƒ€ë¦­',
      'Teemo': 'í‹°ëª¨',
      'Thresh': 'ì“°ë ˆì‰¬',
      'Tristana': 'íŠ¸ë¦¬ìŠ¤íƒ€ë‚˜',
      'Trundle': 'íŠ¸ëŸ°ë“¤',
      'Tryndamere': 'íŠ¸ë¦°ë‹¤ë¯¸ì–´',
      'TwistedFate': 'íŠ¸ìœ„ìŠ¤í‹°ë“œ í˜ì´íŠ¸',
      'Twitch': 'íŠ¸ìœ„ì¹˜',
      'Udyr': 'ìš°ë””ë¥´',
      'Urgot': 'ìš°ë¥´ê³³',
      'Varus': 'ë°”ë£¨ìŠ¤',
      'Vayne': 'ë² ì¸',
      'Veigar': 'ë² ì´ê°€',
      'Velkoz': 'ë²¨ì½”ì¦ˆ',
      'Vex': 'ë²¡ìŠ¤',
      'Vi': 'ë°”ì´',
      'Viego': 'ë¹„ì—ê³ ',
      'Viktor': 'ë¹…í† ë¥´',
      'Vladimir': 'ë¸”ë¼ë””ë¯¸ë¥´',
      'Volibear': 'ë³¼ë¦¬ë² ì–´',
      'Warwick': 'ì›Œìœ…',
      'Wukong': 'ì˜¤ê³µ',
      'Xayah': 'ìì•¼',
      'Xerath': 'ì œë¼ìŠ¤',
      'XinZhao': 'ì‹  ì§œì˜¤',
      'Yasuo': 'ì•¼ìŠ¤ì˜¤',
      'Yone': 'ìš”ë„¤',
      'Yorick': 'ìš”ë¦­',
      'Yuumi': 'ìœ ë¯¸',
      'Zac': 'ìí¬',
      'Zed': 'ì œë“œ',
      'Zeri': 'ì œë¦¬',
      'Ziggs': 'ì§ìŠ¤',
      'Zilean': 'ì§ˆë¦¬ì–¸',
      'Zoe': 'ì¡°ì´',
      'Zyra': 'ìì´ë¼'
    };
    
    // ì˜ë¬¸ ì´ë¦„ìœ¼ë¡œ í•œê¸€ ì´ë¦„ ì°¾ê¸°
    function getKoreanName(englishName) {
      return koreanChampionNames[englishName] || englishName;
    }
    
    // í•œê¸€ ì´ë¦„ìœ¼ë¡œ ì˜ë¬¸ ì´ë¦„ ì°¾ê¸°
    function getEnglishName(koreanName) {
      for (const [english, korean] of Object.entries(koreanChampionNames)) {
        if (korean === koreanName) {
          return english;
        }
      }
      return koreanName; // ë§¤ì¹­ë˜ëŠ” ì˜ë¬¸ ì´ë¦„ì´ ì—†ìœ¼ë©´ ì…ë ¥ê°’ ê·¸ëŒ€ë¡œ ë°˜í™˜
    }
    
    let isHost = false;
    let rerollCount = 2;
    let currentChampion = '';
    let gameStarted = false;
    let hasJoined = false;
    let countdownInterval = null; // ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸ë¥¼ ì €ì¥í•  ì „ì—­ ë³€ìˆ˜
    let isDarkTheme = false;      // í…Œë§ˆ ìƒíƒœ ë³€ìˆ˜
    let bannedChampions = [];     // ë°´ ì±”í”¼ì–¸ ëª©ë¡
    let isBanMode = false;        // ë°´ ëª¨ë“œ ì—¬ë¶€
    let selectedBanChampion = null; // í˜„ì¬ ì„ íƒí•œ ë°´í•  ì±”í”¼ì–¸
    let banTimerInterval = null;  // ë°´ íƒ€ì´ë¨¸ ì¸í„°ë²Œ
    let playerBanStatus = {};     // í”Œë ˆì´ì–´ë³„ ë°´ ìƒíƒœ
    let myTeamBans = [];          // ë‚´ íŒ€ì˜ ë°´ ì±”í”¼ì–¸
    let banPhaseEnded = false;    // ë°´ ë‹¨ê³„ ì¢…ë£Œ ì—¬ë¶€
    
    // í”Œë ˆì´ì–´ í†µê³„ë¥¼ ìœ„í•œ ë³€ìˆ˜
    let playerStats = {
      nickname: '',
      win: 0,
      lose: 0,
      rerollCount: 2
    };
    
    // í˜„ì¬ ê³µì§€ì‚¬í•­ ë²„ì „ - ì—…ë°ì´íŠ¸ë§ˆë‹¤ ìˆ«ìë¥¼ ì˜¬ë ¤ì£¼ì„¸ìš”
    const NOTICE_VERSION = "1.3";

    // ì¿ í‚¤ ì„¤ì • í•¨ìˆ˜
    function setCookie(name, value, days) {
      let expires = "";
      if (days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + value + expires + "; path=/";
    }

    // ì¿ í‚¤ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }

    // íŠ¹ì • ì¿ í‚¤ ì‚­ì œ í•¨ìˆ˜
    function deleteCookie(name) {
      document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/;';
    }

    // í”Œë ˆì´ì–´ ì¢Œì„ ì •ë³´ ì €ì¥ í•¨ìˆ˜
    function saveSeatInfo(team, index) {
      // ì¢Œì„ ì •ë³´ë¥¼ JSONìœ¼ë¡œ ì €ì¥
      const seatInfo = JSON.stringify({
        team: team,
        index: index,
        timestamp: Date.now()
      });
      
      // ì¿ í‚¤ì— 1ì‹œê°„ ë§Œë£Œë¡œ ì €ì¥ (days = 1/24)
      setCookie("playerSeat", seatInfo, 1/24);
    }

    // í”Œë ˆì´ì–´ ì¢Œì„ ì •ë³´ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜
    function getSeatInfo() {
      const seatInfoStr = getCookie("playerSeat");
      if (!seatInfoStr) return null;
      
      try {
        const seatInfo = JSON.parse(seatInfoStr);
        
        // ìœ íš¨ ì‹œê°„ í™•ì¸ (1ì‹œê°„ = 3600000 ë°€ë¦¬ì´ˆ)
        const now = Date.now();
        if (now - seatInfo.timestamp > 3600000) {
          deleteCookie("playerSeat");
          return null;
        }
        
        return seatInfo;
      } catch (e) {
        deleteCookie("playerSeat");
        return null;
      }
    }

    // í”Œë ˆì´ì–´ í†µê³„ ì´ˆê¸°í™” í•¨ìˆ˜
    function initPlayerStats() {
      // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ í†µê³„ í™•ì¸
      const savedStats = localStorage.getItem('playerStats1');
      
      if (savedStats) {
        // ì €ì¥ëœ í†µê³„ê°€ ìˆë‹¤ë©´ ë¶ˆëŸ¬ì˜¤ê¸°
        const parsedStats = JSON.parse(savedStats);
        // ê¸°ì¡´ rerollCount ê°’ ìœ ì§€
        playerStats = {
          ...parsedStats,
          rerollCount: parsedStats.rerollCount || 2 // ê¸°ì¡´ ê°’ì´ ì—†ì„ ê²½ìš°ì—ë§Œ 2ë¡œ ì„¤ì •
        };
        console.log('ì €ì¥ëœ í”Œë ˆì´ì–´ í†µê³„ ì •ë³´ ë¶ˆëŸ¬ì˜´:', playerStats);
      } else {
        // ì €ì¥ëœ í†µê³„ê°€ ì—†ë‹¤ë©´ ê¸°ë³¸ê°’ ì„¤ì •
        playerStats = {
          nickname: `í”Œë ˆì´ì–´${Math.floor(Math.random() * 50) + 1}`, // 1~50 ì‚¬ì´ì˜ ëœë¤ ë²ˆí˜¸
          win: 0,
          lose: 0,
          rerollCount: 2
        };
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
        localStorage.setItem('playerStats1', JSON.stringify(playerStats));
        console.log('ìƒˆ í”Œë ˆì´ì–´ í†µê³„ ì •ë³´ ìƒì„±:', playerStats);
      }
      
      // ì ‘ì† ìƒíƒœ ì €ì¥
      hasJoined = localStorage.getItem('hasJoined') === 'true';
      
      // ì´ë¯¸ ë°©ì— ì°¸ì—¬í•œ ìƒíƒœì˜€ë‹¤ë©´ ë°”ë¡œ í‘œì‹œ
      if (hasJoined) {
        document.getElementById('gameRoom').style.display = 'block';
      }
      
      // ì´ˆê¸° ì ‘ì† ì‹œì—ë§Œ ì„œë²„ì— í†µê³„ ì „ì†¡
      socket.emit('update-player-stats', playerStats);
    }
    
    // í”Œë ˆì´ì–´ í†µê³„ ì €ì¥ í•¨ìˆ˜ (ë¡œì»¬ì—ë§Œ ì €ì¥)
    function savePlayerStats() {
      localStorage.setItem('playerStats1', JSON.stringify(playerStats));
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¿ í‚¤ì—ì„œ í…Œë§ˆ ì„¤ì • ì½ê¸°
    function loadThemeFromCookie() {
      const savedTheme = getCookie("darkMode");
      if (savedTheme === "true") {
        isDarkTheme = true;
        document.documentElement.setAttribute('data-theme', 'dark');
        document.getElementById('themeSwitch').textContent = 'ğŸŒ™';
      } else {
        isDarkTheme = false;
        document.documentElement.setAttribute('data-theme', 'light');
        document.getElementById('themeSwitch').textContent = 'ğŸŒ';
      }
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ í…Œë§ˆ ì„¤ì • ë¡œë“œ
    document.addEventListener('DOMContentLoaded', () => {
      loadThemeFromCookie();
      initPlayerStats(); // í”Œë ˆì´ì–´ í†µê³„ ì´ˆê¸°í™”
      
      // ì´ˆê¸° ë¡œë“œ ì‹œ ë°´ ì±”í”¼ì–¸ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
      const bannedChampionsSection = document.getElementById('bannedChampionsSection');
      if (bannedChampionsSection) {
        bannedChampionsSection.style.display = 'none';
      }
      
      // game-statusë¥¼ ìƒë‹¨ì— ê³ ì •
      makeGameStatusFixed();
      
      setTimeout(showNotice, 1000); // 1ì´ˆ í›„ ê³µì§€ì‚¬í•­ í‘œì‹œ
    });
    
    // game-statusë¥¼ ìƒë‹¨ì— ê³ ì •í•˜ëŠ” í•¨ìˆ˜
    function makeGameStatusFixed() {
      const gameStatus = document.getElementById('gameStatus');
      const contentWrapper = document.getElementById('contentWrapper');
      const container = document.querySelector('.container');
      
      if (gameStatus && contentWrapper && container) {
        // fixed-game-status í´ë˜ìŠ¤ ì¶”ê°€
        gameStatus.classList.add('fixed-game-status');
        
        // ì½˜í…ì¸ ì— ì—¬ë°± ì¶”ê°€
        contentWrapper.classList.add('status-padding');
        
        // í™”ë©´ í¬ê¸°ì— ë”°ë¼ ì¡°ì •í•˜ëŠ” í•¨ìˆ˜
        function adjustGameStatus() {
          const containerRect = container.getBoundingClientRect();
          
          // ì»¨í…Œì´ë„ˆì˜ ë„ˆë¹„ì— ë§ì¶¤
          gameStatus.style.width = container.offsetWidth + 'px';
          
          // ì»¨í…Œì´ë„ˆì˜ ì¢Œì¸¡ ìœ„ì¹˜ì— ë§ì¶¤ (ê°€ìš´ë° ì •ë ¬)
          gameStatus.style.left = containerRect.left + 'px';
          gameStatus.style.right = 'auto';
          
          // ê²Œì„ ìƒíƒœ ë©”ì‹œì§€ ê¸€ì í¬ê¸° ì¡°ì •
          const gameStatusMessage = document.getElementById('gameStatusMessage');
          if (gameStatusMessage) {
            if (window.innerWidth < 500) {
              gameStatusMessage.style.fontSize = '0.9em';
            } else {
              gameStatusMessage.style.fontSize = '1.2em';
            }
          }
        }
        
        // ì´ˆê¸° ì‹¤í–‰
        adjustGameStatus();
        
        // ë¦¬ì‚¬ì´ì¦ˆ ë° ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ì— ì—°ê²°
        window.addEventListener('resize', adjustGameStatus);
        window.addEventListener('scroll', adjustGameStatus);
        
        // í™”ë©´ íšŒì „ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼)
        window.addEventListener('orientationchange', function() {
          setTimeout(adjustGameStatus, 100);
        });
      }
    }

    // ì´ˆê¸° í™”ë©´ ì„¤ì •
    socket.on('connect', () => {
      console.log('ì„œë²„ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤. ì†Œì¼“ ID:', socket.id);
      
      // ì†Œì¼“ IDë¥¼ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
      const prevSocketId = localStorage.getItem('socketId');
      localStorage.setItem('socketId', socket.id);
      
      // ì´ì „ì— ì €ì¥ëœ í†µê³„ ì •ë³´ê°€ ìˆìœ¼ë©´ ì„œë²„ì— ì „ì†¡
      const savedStats = localStorage.getItem('playerStats1');
      let stats = null;
      
      if (savedStats) {
        stats = JSON.parse(savedStats);
        // ì†Œì¼“ IDê°€ ë³€ê²½ëœ ê²½ìš°(ì¬ì ‘ì†) ê¸°ì¡´ í†µê³„ ì •ë³´ë¥¼ ì„œë²„ì— ì „ì†¡
        if (prevSocketId !== socket.id) {
          console.log('ì¬ì ‘ì† ê°ì§€: í†µê³„ ì •ë³´ ì „ì†¡');
          
          // ì €ì¥ëœ ì¢Œì„ ì •ë³´ í™•ì¸
          const seatInfo = getSeatInfo();
          if (seatInfo) {
            console.log('ì €ì¥ëœ ì¢Œì„ ì •ë³´:', seatInfo);
            stats.seatInfo = seatInfo; // ì¢Œì„ ì •ë³´ ì¶”ê°€
            
            // ì¬ì ‘ì† ì‹œ ì¢Œì„ ì •ë³´ê°€ ìˆì„ ë•Œ í† ìŠ¤íŠ¸ ì•Œë¦¼ í‘œì‹œ
            Toastify({
              text: `ì¬ì ‘ì† ê°ì§€: ${getTeamDisplayName(seatInfo.team)} ${seatInfo.index + 1}ë²ˆ ìë¦¬ë¡œ ìë™ ì ‘ì†í•©ë‹ˆë‹¤.`,
              duration: 3000,
              gravity: "top",
              position: "center",
              style: {
                background: "linear-gradient(to right, #00b09b, #96c93d)",
                color: "white",
                fontWeight: "bold",
                fontSize: "14px",
                padding: "12px",
                borderRadius: "5px"
              }
            }).showToast();
          } else {
            // ì¢Œì„ ì •ë³´ ì—†ì´ ì¬ì ‘ì†í•  ë•Œ í† ìŠ¤íŠ¸ ì•Œë¦¼
            Toastify({
              text: "ì¬ì ‘ì† ê°ì§€: ëŒ€ê¸°ì‹¤ì— ë°°ì¹˜ë©ë‹ˆë‹¤.",
              duration: 3000,
              gravity: "top",
              position: "center",
              style: {
                background: "linear-gradient(to right, #3498db, #2980b9)",
                color: "white",
                fontWeight: "bold",
                fontSize: "14px",
                padding: "12px",
                borderRadius: "5px"
              }
            }).showToast();
          }
          
          socket.emit('reconnect-player', stats);
        }
      }
      
      // ì´ë¯¸ ë°© ìƒì„± ì¤‘ì´ ì•„ë‹ ë•Œë§Œ ë°© ìƒíƒœ ì²´í¬
      if (!isCreatingRoom && !hasJoined) {
        socket.emit('check-room');
      }
    });

    // ë‹‰ë„¤ì„ ë³€ê²½ í•¨ìˆ˜
    function changeNickname() {
      const newNickname = document.getElementById('nicknameInput').value.trim();
      if (newNickname) {
        socket.emit('change-nickname', newNickname);
        // í”Œë ˆì´ì–´ í†µê³„ì—ë„ ë‹‰ë„¤ì„ ì—…ë°ì´íŠ¸
        playerStats.nickname = newNickname;
        savePlayerStats();
        // ë‹‰ë„¤ì„ì´ ë³€ê²½ë˜ì—ˆìœ¼ë¯€ë¡œ ì„œë²„ì— í†µê³„ ì „ì†¡
        socket.emit('update-player-stats', playerStats);
        document.getElementById('nicknameInput').value = '';
      }
    }
    
    // ì„œë²„ì—ì„œ í†µê³„ ì •ë³´ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
    socket.on('player-stats-updated', (updatedStats) => {
      console.log('ì„œë²„ì—ì„œ í†µê³„ ì •ë³´ ì—…ë°ì´íŠ¸ ìˆ˜ì‹ :', updatedStats);
      // ë¡œì»¬ í†µê³„ ì •ë³´ ì—…ë°ì´íŠ¸
      playerStats = {
        ...playerStats,
        ...updatedStats
      };
      savePlayerStats();
    });

    // ë‹‰ë„¤ì„ ì—ëŸ¬ ì²˜ë¦¬
    socket.on('nickname-error', (message) => {
      alert(message);
    });

    // ë‹‰ë„¤ì„ ë³€ê²½ ì„±ê³µ
    socket.on('nickname-changed', (newNickname) => {
      alert('ë‹‰ë„¤ì„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤: ' + newNickname);
      // í”Œë ˆì´ì–´ í†µê³„ì—ë„ ë‹‰ë„¤ì„ ì—…ë°ì´íŠ¸
      playerStats.nickname = newNickname;
      savePlayerStats();
      // ë‹‰ë„¤ì„ì´ ë³€ê²½ë˜ì—ˆìœ¼ë¯€ë¡œ ì„œë²„ì— í†µê³„ ì „ì†¡
      socket.emit('update-player-stats', playerStats);
    });

    // íŒ€ ì´ë¦„ì„ í‘œì‹œ ì´ë¦„ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
    function getTeamDisplayName(team) {
      if (team === 'team1') return 'íŒ€ 1';
      if (team === 'team2') return 'íŒ€ 2';
      return 'ëŒ€ê¸°ì‹¤';
    }

    // ë°© ìƒì„± ì¤‘ ìƒíƒœ ê´€ë¦¬ ë³€ìˆ˜
    let isCreatingRoom = false;

    // ë°© ìƒíƒœ í™•ì¸
    socket.on('room-status', (hasRoom) => {
      if (hasRoom) {
        // ë°©ì´ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ ì…ì¥
        if (!hasJoined) {
          console.log('ìƒˆë¡œìš´ í”Œë ˆì´ì–´ë¡œ ë°© ì…ì¥');
          hasJoined = true;
          localStorage.setItem('hasJoined', 'true');
          socket.emit('join-room');
        } else {
          console.log('ì´ë¯¸ ì°¸ì—¬í•œ ìƒíƒœë¡œ ë°© ì¬ì…ì¥');
        }
        document.getElementById('gameRoom').style.display = 'block';
        document.getElementById('resetRoomBtn').disabled = false;
        
        // ë°© ìƒì„± ì¤‘ ìƒíƒœ ì´ˆê¸°í™”
        isCreatingRoom = false;
      } else {
        // ë°©ì´ ì—†ìœ¼ë©´ ë¬´ì¡°ê±´ hasJoined ì´ˆê¸°í™”í•˜ê³  ë°© ìƒì„± í”„ë¡œì„¸ìŠ¤ ì‹œì‘
        console.log('ë°©ì´ ì—†ìŠµë‹ˆë‹¤. ìƒì„± í”„ë¡œì„¸ìŠ¤ ì‹œì‘');
        hasJoined = false;
        localStorage.removeItem('hasJoined');
        document.getElementById('gameRoom').style.display = 'none';
        
        // ì´ë¯¸ ë°© ìƒì„± ì¤‘ì´ë©´ ì¤‘ë³µ í”„ë¡¬í”„íŠ¸ ë°©ì§€
        if (isCreatingRoom) {
          console.log('ì´ë¯¸ ë°© ìƒì„± ì¤‘ì…ë‹ˆë‹¤. ì¤‘ë³µ í”„ë¡¬í”„íŠ¸ ë°©ì§€');
          return;
        }
        
        // ë°© ìƒì„± ì¤‘ ìƒíƒœë¡œ ì„¤ì •
        isCreatingRoom = true;
        
        const password = prompt('ìƒì„±ëœ ë°©ì´ ì—†ìŠµë‹ˆë‹¤ ë°©ì„ ìƒì„±í•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
        if (password === 'star') {
          console.log('ë°© ìƒì„± ì‹œ ì „ì†¡í•  í†µê³„ ì •ë³´:', playerStats);
          socket.emit('create-room', { 
            name: 'ë¡¤ ëœë¤ ì±”í”¼ì–¸ ë½‘ê¸°',
            stats: playerStats
          });
          isHost = true;
          hasJoined = true;
          localStorage.setItem('hasJoined', 'true');
          
          document.getElementById('nicknameInput').placeholder = playerStats.nickname;
          document.getElementById('gameRoom').style.display = 'block';
          document.getElementById('resetGameBtn').disabled = false;
          document.getElementById('resetRoomBtn').disabled = false;
        } else {
          // ë°© ìƒì„± ì·¨ì†Œ ì‹œ ìƒíƒœ ì´ˆê¸°í™”
          isCreatingRoom = false;
          alert('í˜¸ìŠ¤íŠ¸ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.');
        }
      }
    });

    // ìë¦¬ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateSeats(players, containerId) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      
      // ë°´ ëª¨ë“œ ìƒíƒœì¸ì§€ í™•ì¸
      const isBanPhaseActive = document.getElementById('bannedChampionsSection').classList.contains('ban-mode');
      
      players.forEach((player, index) => {
        const seat = document.createElement('div');
        seat.className = `seat ${player ? 'taken' : ''} ${containerId.includes('team1') ? 'team1' : 
                         containerId.includes('team2') ? 'team2' : 'waiting'}`;
        
        if (player) {
          const isCurrentPlayer = player.id === socket.id;
          const isSameTeam = (containerId.includes('team1') && socket.team === 'team1') || 
                            (containerId.includes('team2') && socket.team === 'team2');
          
          // ìŠ¹ë¥  ê³„ì‚°
          const winRate = player.stats && (player.stats.win + player.stats.lose > 0) ? 
                         Math.round((player.stats.win / (player.stats.win + player.stats.lose)) * 100) : 0;
          
          seat.innerHTML = `
            <div class="player-info">
              <div class="player-name ${isCurrentPlayer ? 'self' : ''} ${player.isHost ? 'host' : ''}">
                ${player.nickname}${player.isHost ? ' ğŸ‘‘' : ''}
                ${player.stats ? `
                <div class="player-stats">
                  <span class="win">${player.stats.win}ìŠ¹</span> 
                  <span class="lose">${player.stats.lose}íŒ¨</span> 
                  <span class="winrate">(${winRate}%)</span>
                </div>` : ''}
              </div>
              ${player.champion ? 
                (isCurrentPlayer || isSameTeam ? 
                `<div class="champion-display"><img src="/champions/${player.champion}.png" alt="${player.champion}" title="${player.champion}"></div>` : 
                `<div class="champion-display unknown">???</div>`) : ''}
            </div>
          `;
          
          // ìƒˆë¡œ ì¶”ê°€ëœ í”Œë ˆì´ì–´ì—ê²Œ ì• ë‹ˆë©”ì´ì…˜ ì ìš©
          if (isCurrentPlayer && player.justMoved) {
            seat.classList.add('moving');
            // ì• ë‹ˆë©”ì´ì…˜ì´ ëë‚˜ë©´ í´ë˜ìŠ¤ ì œê±°
            setTimeout(() => {
              seat.classList.remove('moving');
            }, 800);
          }
        } else {
          seat.innerHTML = `
            <div class="player-info">
              <div>ìë¦¬ ${index + 1}</div>
            </div>
            ${!gameStarted && !isBanPhaseActive ? '<button class="select-btn">ì„ íƒí•˜ê¸°</button>' : ''}
          `;
          if (!gameStarted && !isBanPhaseActive) {
            seat.querySelector('.select-btn').addEventListener('click', () => {
              const selectedTeam = containerId.includes('team1') ? 'team1' : 
                                 containerId.includes('team2') ? 'team2' : 'waiting';
              socket.team = selectedTeam;
              
              // ì†Œì¼“ ì´ë²¤íŠ¸ ì „ì†¡
              socket.emit('select-seat', {
                team: selectedTeam,
                index
              });
              
              // ìë¦¬ ì„ íƒ ì‹œ ì¿ í‚¤ì— ì¢Œì„ ì •ë³´ ì €ì¥
              saveSeatInfo(selectedTeam, index);
              
              // ìë¦¬ ì„ íƒ ì‹œ ì§„í–‰ ì¤‘ì¸ ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ë¥¼ ëª¨ë‘ ì œê±°
              document.querySelectorAll('.seat.moving').forEach(el => {
                el.classList.remove('moving');
              });
            });
          }
        }
        container.appendChild(seat);
      });
    }

    // ë¦¬ë¡¤ ì—…ë°ì´íŠ¸
    socket.on('reroll-update', (count) => {
      const rerollBtn = document.getElementById('rerollBtn');
      if (rerollBtn) {
        rerollBtn.disabled = count <= 0;
        console.log('ë¦¬ë¡¤ ë²„íŠ¼ ì—…ë°ì´íŠ¸ ì™„ë£Œ:', {
          disabled: rerollBtn.disabled
        });
        
        // ë¦¬ë¡¤ ì¹´ìš´íŠ¸ê°€ ë³€ê²½ëœ ê²½ìš°ì—ë§Œ ì—…ë°ì´íŠ¸
        if (playerStats.rerollCount !== count) {
          // í”Œë ˆì´ì–´ í†µê³„ ì—…ë°ì´íŠ¸
          playerStats.rerollCount = count;
          savePlayerStats();
        }
        
        // ë¦¬ë¡¤ íšŸìˆ˜ Toastify ì•Œë¦¼
        Toastify({
          text: `ë¦¬ë¡¤ ì”ì—¬ íšŸìˆ˜: ${count}íšŒ`,
          duration: 1500,
          gravity: "bottom",
          position: "right",
          style: {
            background: "linear-gradient(to right, #2196F3, #1976D2)",
            color: "white",
            fontWeight: "bold",
            fontSize: "14px",
            padding: "12px",
            borderRadius: "5px"
          }
        }).showToast();
      }
    });

    // ì±”í”¼ì–¸ í• ë‹¹
    socket.on('champion-assigned', (champion) => {
      currentChampion = champion;
      updateChampionDisplay();
    });

    // ê²Œì„ ìƒíƒœ ì—…ë°ì´íŠ¸
    socket.on('game-state', (state) => {
      // ê²Œì„ ìƒíƒœ ìˆ˜ì‹  ì‹œ ê²Œì„ í™”ë©´ í‘œì‹œ í™•ì¸
      if (hasJoined && document.getElementById('gameRoom').style.display === 'none') {
        console.log('ê²Œì„ ìƒíƒœ ìˆ˜ì‹  ì‹œ ê²Œì„ë£¸ì´ ìˆ¨ê²¨ì ¸ ìˆì–´ í‘œì‹œë¡œ ë³€ê²½');
        document.getElementById('gameRoom').style.display = 'block';
      }
      
      // ê²Œì„ ì‹œì‘ ì—¬ë¶€ í™•ì¸ (ì±”í”¼ì–¸ì´ í• ë‹¹ëœ í”Œë ˆì´ì–´ê°€ ìˆëŠ”ì§€ í™•ì¸)
      gameStarted = [...state.team1, ...state.team2].some(player => player && player.champion);
      
      
      // ë°´ ë‹¨ê³„ í™œì„±í™” ì—¬ë¶€ í™•ì¸
      const isBanPhaseActive = document.querySelector('.teams-container').classList.contains('ban-mode');
      
      // ê²Œì„ ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
      const gameStatusMessage = document.getElementById('gameStatusMessage');
      if (gameStarted) {
        gameStatusMessage.textContent = 'ê²Œì„ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!';
        gameStatusMessage.style.color = '#4CAF50';
        // ê²Œì„ ì‹œì‘ë˜ë©´ ë°´ ì»¨íŠ¸ë¡¤ ìˆ¨ê¸°ê¸°
        document.getElementById('banPhaseControls').style.display = 'none';
        // ê²Œì„ ì‹œì‘ë˜ë©´ ë°´ ì±”í”¼ì–¸ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
        document.getElementById('bannedChampionsSection').style.display = 'none';
        // íŒ€ ì»¨í…Œì´ë„ˆì— no-ban í´ë˜ìŠ¤ ì¶”ê°€
        document.querySelector('.teams-container').classList.add('no-ban');
      } else {
        gameStatusMessage.textContent = 'ê²Œì„ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. íŒ€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.';
        // ê²Œì„ ì‹œì‘ ì „ì´ê³  ë°´ ë‹¨ê³„ê°€ ì•„ë‹ ë•Œ í˜¸ìŠ¤íŠ¸ë§Œ ë°´ ì»¨íŠ¸ë¡¤ í‘œì‹œ
        document.getElementById('banPhaseControls').style.display = isBanPhaseActive ? 'block' : (isHost ? 'flex' : 'none');
        // ê¸°ë³¸ì ìœ¼ë¡œ ë°´ ì±”í”¼ì–¸ ì„¹ì…˜ ìˆ¨ê¸°ê¸° (ë°´ ë‹¨ê³„ê°€ ì‹œì‘ë  ë•Œë§Œ í‘œì‹œ)
        document.getElementById('bannedChampionsSection').style.display = isBanPhaseActive ? 'block' : 'none';
        // íŒ€ ì»¨í…Œì´ë„ˆì— no-ban í´ë˜ìŠ¤ ì¶”ê°€
        document.querySelector('.teams-container').classList.add(isBanPhaseActive ? 'ban-mode' : 'no-ban');
      }
      
      updateSeats(state.team1, 'team1Seats');
      updateSeats(state.team2, 'team2Seats');
      updateSeats(state.waiting, 'waitingSeats');
      
      // ë°´ ì±”í”¼ì–¸ ëª©ë¡ ì—…ë°ì´íŠ¸
      if (state.bannedChampions) {
        bannedChampions = state.bannedChampions;
        updateBannedChampions();
      }
      
      // ë‚´ íŒ€ ì°¾ê¸° (ê²Œì„ ìƒíƒœ ê°±ì‹ ì‹œì—ë„ ë‚´ íŒ€ í™•ì¸)
      let myTeam = null;
      const allPlayers = [...state.team1, ...state.team2, ...state.waiting];
      const currentPlayer = allPlayers.find(p => p && p.id === socket.id);
      
      if (currentPlayer) {
        myTeam = currentPlayer.team;
        socket.team = myTeam;
        
        // í˜„ì¬ í”Œë ˆì´ì–´ì˜ í†µê³„ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        if (currentPlayer.stats) {
          // í”Œë ˆì´ì–´ í†µê³„ ì •ë³´ì— ë³€í™”ê°€ ìˆëŠ”ì§€ í™•ì¸
          const statsChanged = 
            playerStats.win !== currentPlayer.stats.win ||
            playerStats.lose !== currentPlayer.stats.lose ||
            playerStats.rerollCount !== currentPlayer.stats.rerollCount;
          
          if (statsChanged) {
            // í”Œë ˆì´ì–´ í†µê³„ ì •ë³´ ì—…ë°ì´íŠ¸
            playerStats = {
              ...playerStats,
              win: currentPlayer.stats.win,
              lose: currentPlayer.stats.lose,
              rerollCount: currentPlayer.stats.rerollCount
            };
            savePlayerStats();
          }
        }
      } else {
        // í”Œë ˆì´ì–´ë¥¼ ì°¾ì§€ ëª»í–ˆì„ ê²½ìš° team1ê³¼ team2ì—ì„œ ì§ì ‘ ì°¾ê¸°
        const team1Player = state.team1.find(p => p && p.id === socket.id);
        if (team1Player) {
          myTeam = 'team1';
          socket.team = myTeam;
        }
        
        const team2Player = state.team2.find(p => p && p.id === socket.id);
        if (team2Player) {
          myTeam = 'team2';
          socket.team = myTeam;
        }
      }
      
      // ê°™ì€ íŒ€ì˜ ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        if (myTeam && state[`${myTeam}Champions`]) {
          updateChampionList(state[`${myTeam}Champions`]);
      }
      
      // í˜¸ìŠ¤íŠ¸ì¸ ê²½ìš°ì—ë§Œ ì‹œì‘ ë²„íŠ¼ í™œì„±í™”
      if (isHost) {
        const hasWaitingPlayers = state.waiting.some(p => p !== null);
        // ë°´ ë‹¨ê³„ì—ì„œëŠ” ê²Œì„ ì‹œì‘ ë²„íŠ¼ ë¹„í™œì„±í™”
        document.getElementById('startGameBtn').disabled = hasWaitingPlayers || gameStarted || isBanPhaseActive;
        document.getElementById('resetGameBtn').disabled = !gameStarted;
        document.getElementById('resetRoomBtn').disabled = false;
        
        // ëœë¤ ë°°ì • ë²„íŠ¼ í™œì„±í™” ì¡°ê±´: 
        // 1. ëŒ€ê¸°ì‹¤ì— í”Œë ˆì´ì–´ê°€ ìˆê³  
        // 2. ê²Œì„ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìœ¼ë©°
        // 3. íŒ€1ê³¼ íŒ€2ì— í”Œë ˆì´ì–´ê°€ ì—†ì–´ì•¼ í•¨
        const hasPlayersInWaiting = state.waiting.some(p => p !== null);
        const hasPlayersInTeam1 = state.team1.some(p => p !== null);
        const hasPlayersInTeam2 = state.team2.some(p => p !== null);
        document.getElementById('randomAssignBtn').disabled = !hasPlayersInWaiting || gameStarted || hasPlayersInTeam1 || hasPlayersInTeam2;
      }

      // ë¦¬ë¡¤ ë²„íŠ¼ ì—…ë°ì´íŠ¸
      if (currentPlayer) {
        const rerollBtn = document.getElementById('rerollBtn');
        // í˜„ì¬ í”Œë ˆì´ì–´ì˜ ë¦¬ë¡¤ íšŸìˆ˜ ì—…ë°ì´íŠ¸
        const rerollCount = currentPlayer.stats ? currentPlayer.stats.rerollCount : 2;
        
        // ë¦¬ë¡¤ ë²„íŠ¼ ë¹„í™œì„±í™” ì¡°ê±´:
        // 1. ê²Œì„ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ê±°ë‚˜
        // 2. ë¦¬ë¡¤ íšŸìˆ˜ê°€ 0ì´ê±°ë‚˜
        // 3. ë¦¬ë¡¤ íšŸìˆ˜ê°€ ì—†ëŠ” ê²½ìš°
        rerollBtn.disabled = !gameStarted || !rerollCount || rerollCount <= 0;
        
        // ë¦¬ë¡¤ íšŸìˆ˜ í‘œì‹œ ì—…ë°ì´íŠ¸
        let rerollCountDisplay = document.querySelector('.reroll-count-display');
        if (!rerollCountDisplay) {
          rerollCountDisplay = document.createElement('span');
          rerollCountDisplay.className = 'reroll-count-display';
          rerollBtn.parentNode.insertBefore(rerollCountDisplay, rerollBtn.nextSibling);
        }
        rerollCountDisplay.textContent = ` (${rerollCount}íšŒ)`;
        
        // í”Œë ˆì´ì–´ í†µê³„ì˜ ë¦¬ë¡¤ ì¹´ìš´íŠ¸ê°€ ì„œë²„ì™€ ë‹¤ë¥¼ ê²½ìš°ì—ë§Œ ì—…ë°ì´íŠ¸
        if (playerStats.rerollCount !== rerollCount) {
          playerStats.rerollCount = rerollCount;
          savePlayerStats();
        }
      } else {
        // í”Œë ˆì´ì–´ê°€ ì—†ëŠ” ê²½ìš° ê¸°ë³¸ê°’ í‘œì‹œ
        const rerollBtn = document.getElementById('rerollBtn');
        rerollBtn.disabled = !gameStarted;
      }
    });

    // ê²Œì„ ì´ˆê¸°í™” ì´ë²¤íŠ¸
    socket.on('game-reset', () => {
      console.log('ê²Œì„ ì´ˆê¸°í™” ì´ë²¤íŠ¸ ìˆ˜ì‹ ');
      
      const rerollBtn = document.getElementById('rerollBtn');
      rerollBtn.disabled = true;
      
      // ê²Œì„ ì´ˆê¸°í™”ì‹œ ë°´ ì±”í”¼ì–¸ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
      document.getElementById('bannedChampionsSection').style.display = 'none';
      
      // ë°´ ëª©ë¡ ì´ˆê¸°í™”
      bannedChampions = [];
      playerBanStatus = {};
      banPhaseEnded = false;  // ë°´ ë‹¨ê³„ ì¢…ë£Œ í”Œë˜ê·¸ ì´ˆê¸°í™”
      
      // íŒ€ ì»¨í…Œì´ë„ˆì— no-ban í´ë˜ìŠ¤ ì¶”ê°€
      document.querySelector('.teams-container').classList.add('no-ban');
      document.querySelector('.teams-container').classList.remove('ban-mode');
      
      // íŒ€ì—ì„œ my-team í´ë˜ìŠ¤ ì œê±°
      document.querySelectorAll('.team').forEach(team => {
        team.classList.remove('my-team');
      });
      
      // ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™”ë¥¼ ì—¬ëŸ¬ ë²ˆ ì‹œë„í•˜ì—¬ í™•ì‹¤íˆ ì²˜ë¦¬
      // ì¦‰ì‹œ í•œ ë²ˆ ì‹¤í–‰
      forceResetAllBanSlots();
      
      // ì•½ê°„ì˜ ì§€ì—° í›„ í•œ ë²ˆ ë” ì‹¤í–‰ (ë¹„ë™ê¸° ë„¤íŠ¸ì›Œí¬ ì§€ì—° ê³ ë ¤)
      setTimeout(() => {
        forceResetAllBanSlots();
      }, 100);
      
      // ì¡°ê¸ˆ ë” ì§€ì—° í›„ í•œ ë²ˆ ë” ì‹¤í–‰ (í™”ë©´ ë¦¬í”„ë ˆì‹œ ë“±ì˜ ìƒí™© ê³ ë ¤)
      setTimeout(() => {
        forceResetAllBanSlots();
      }, 500);
      
      // ì´ˆê¸°í™” ì•Œë¦¼
        Toastify({
        text: "ê²Œì„ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.",
          duration: 1500,
          gravity: "top",
          position: "center",
          style: {
          background: "linear-gradient(to right, #4CAF50, #2E7D32)",
            color: "white",
            fontWeight: "bold",
          fontSize: "14px",
          padding: "12px",
            borderRadius: "5px"
          }
        }).showToast();
    });

    // ê²Œì„ ì´ˆê¸°í™” ë²„íŠ¼
    document.getElementById('resetGameBtn').addEventListener('click', () => {
      if (!gameStarted) {
        Toastify({
          text: "ê²Œì„ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.",
          duration: 1500,
          gravity: "top",
          position: "center",
          style: {
            background: "linear-gradient(to right, #ff9800, #f57c00)",
            color: "white",
            fontWeight: "bold",
            fontSize: "16px",
            padding: "15px",
            borderRadius: "5px"
          }
        }).showToast();
        return;
      }
      
      // ìŠ¹ë¦¬ íŒ€ ì„ íƒ ëŒ€í™”ìƒì í‘œì‹œ
      Toastify({
        text: "ìŠ¹ë¦¬í•œ íŒ€ì„ ì„ íƒí•´ì£¼ì„¸ìš”",
        duration: 3000,
        gravity: "top",
        position: "center",
        style: {
          background: "linear-gradient(to right, #4CAF50, #2E7D32)",
          color: "white",
          fontWeight: "bold",
          fontSize: "16px",
          padding: "15px",
          borderRadius: "5px"
        }
      }).showToast();
      
      // ìŠ¹ë¦¬ íŒ€ ì„ íƒ ëª¨ë‹¬ í‘œì‹œ
      const modal = document.createElement('div');
      modal.className = 'win-modal';
      modal.innerHTML = `
        <div class="win-modal-content">
          <h3>ìŠ¹ë¦¬ íŒ€ ì„ íƒ</h3>
          <p>ìŠ¹ë¦¬í•œ íŒ€ì„ ì„ íƒí•˜ë©´ íŒ¨ë°°í•œ íŒ€ì—ê²Œ ë¦¬ë¡¤ +1ì´ ì ë¦½ë©ë‹ˆë‹¤.</p>
          <div class="win-team-buttons">
            <button id="team1Win">íŒ€ 1 ìŠ¹ë¦¬</button>
            <button id="team2Win">íŒ€ 2 ìŠ¹ë¦¬</button>
            <button id="noWinner">ì·¨ì†Œ</button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
      
      // ëª¨ë‹¬ ìŠ¤íƒ€ì¼
      const style = document.createElement('style');
      style.textContent = `
        .win-modal {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.7);
          display: flex;
          justify-content: center;
          align-items: center;
          z-index: 1000;
        }
        .win-modal-content {
          background-color: var(--container-bg);
          color: var(--text-color);
          padding: 20px;
          border-radius: 10px;
          text-align: center;
          max-width: 400px;
          width: 100%;
        }
        .win-team-buttons {
          display: flex;
          flex-direction: column;
          gap: 10px;
          margin-top: 20px;
        }
        .win-team-buttons button {
          padding: 10px 20px;
          border: none;
          border-radius: 5px;
          cursor: pointer;
          font-weight: bold;
          transition: all 0.3s ease;
        }
        #team1Win {
          background-color: var(--team1-border);
          color: white;
        }
        #team2Win {
          background-color: var(--team2-border);
          color: white;
        }
        #noWinner {
          background-color: var(--button-bg);
          color: white;
        }
        .win-team-buttons button:hover {
          opacity: 0.9;
          transform: scale(1.05);
        }
      `;
      document.head.appendChild(style);
      
      // ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document.getElementById('team1Win').addEventListener('click', () => {
        // ìŠ¹ë¦¬ íŒ€ ì •ë³´ë§Œ ì„œë²„ì— ì „ì†¡í•˜ê³  ìŠ¹íŒ¨ ì²˜ë¦¬ëŠ” ì„œë²„ì—ì„œ ìˆ˜í–‰
        socket.emit('reset-game', { winningTeam: 'team1', resetBans: true });
        document.body.removeChild(modal);
        
        // ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” - ì¦‰ì‹œ ì´ˆê¸°í™” ì²˜ë¦¬
        forceResetAllBanSlots();
        banPhaseEnded = false;
      });
      
      document.getElementById('team2Win').addEventListener('click', () => {
        // ìŠ¹ë¦¬ íŒ€ ì •ë³´ë§Œ ì„œë²„ì— ì „ì†¡í•˜ê³  ìŠ¹íŒ¨ ì²˜ë¦¬ëŠ” ì„œë²„ì—ì„œ ìˆ˜í–‰
        socket.emit('reset-game', { winningTeam: 'team2', resetBans: true });
        document.body.removeChild(modal);
        
        // ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” - ì¦‰ì‹œ ì´ˆê¸°í™” ì²˜ë¦¬
        forceResetAllBanSlots();
        banPhaseEnded = false;
      });
      
      document.getElementById('noWinner').addEventListener('click', () => {
        socket.emit('reset-game', { winningTeam: null, resetBans: true });
        document.body.removeChild(modal);
        
        // ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” - ì¦‰ì‹œ ì´ˆê¸°í™” ì²˜ë¦¬
        forceResetAllBanSlots();
        banPhaseEnded = false;
      });
    });
    
    // ê°•ì œ ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” - ë” ê°•ë ¥í•œ ë²„ì „
    function forceResetAllBanSlots() {
      console.log('ê°•ì œ ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” ì‹¤í–‰');
      
      try {
        // ëª¨ë“  íŒ€ì˜ ëª¨ë“  ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™”
        const allBanSlots = document.querySelectorAll('.team-ban-slots .ban-slot');
        
        allBanSlots.forEach((slot, index) => {
          // ê¸°ì¡´ ë‚´ìš©ë¬¼ ì „ì²´ ì‚­ì œ
          while(slot.firstChild) {
            slot.removeChild(slot.firstChild);
          }
          
          // empty í´ë˜ìŠ¤ ì¶”ê°€ ë° ìŠ¤íƒ€ì¼ ì§ì ‘ ì„¤ì •
          slot.classList.add('empty');
          
          // ì¶”ê°€ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
          slot.style.backgroundImage = '';
          slot.style.opacity = '';
        });
        
        // ì¤‘ì•™ ë°´ ì„¹ì…˜ ì´ˆê¸°í™”
        const bannedChampionsContainer = document.getElementById('bannedChampions');
        if (bannedChampionsContainer) {
          bannedChampionsContainer.innerHTML = '<div class="empty-champion-list">ë°´ëœ ì±”í”¼ì–¸ì´ ì—†ìŠµë‹ˆë‹¤</div>';
        }
        
        // ìˆ¨ê²¨ì§„ ë°´ ìŠ¬ë¡¯ í‘œì‹œ ë³µì› (ë¹„ì£¼ì–¼ ì´ˆê¸°í™”)
        document.querySelectorAll('.team-ban-slots').forEach(slot => {
          slot.style.visibility = '';
          slot.style.display = '';
        });
        
        // ê°•ì œ ë¦¬í”Œë¡œìš° ë° ë Œë”ë§ íŠ¸ë¦¬ê±°
        void document.body.offsetHeight;
        document.documentElement.style.display = 'none';
        document.documentElement.offsetHeight;
        document.documentElement.style.display = '';
      } catch (error) {
        console.error('ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
      }
    }
    
    // ê¸°ì¡´ ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” í•¨ìˆ˜ - ë°±ì—…
    function resetBanSlots() {
      console.log('ê¸°ë³¸ ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” ì‹¤í–‰');
      
      // íŒ€1 ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™”
      const team1BanSlots = document.querySelectorAll('.teams-container .team:first-child .team-ban-slots .ban-slot');
      team1BanSlots.forEach(slot => {
        slot.innerHTML = '';
        slot.classList.add('empty');
      });
      
      // íŒ€2 ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™”
      const team2BanSlots = document.querySelectorAll('.teams-container .team:last-child .team-ban-slots .ban-slot');
      team2BanSlots.forEach(slot => {
        slot.innerHTML = '';
        slot.classList.add('empty');
      });
      
      // ì¤‘ì•™ ë°´ ì„¹ì…˜ ì´ˆê¸°í™”
      const bannedChampionsContainer = document.getElementById('bannedChampions');
      if (bannedChampionsContainer) {
        bannedChampionsContainer.innerHTML = '<div class="empty-champion-list">ë°´ëœ ì±”í”¼ì–¸ì´ ì—†ìŠµë‹ˆë‹¤</div>';
      }
      
      // ìŠ¬ë¡¯ ìƒíƒœ ì ìš©ì„ ìœ„í•œ ê°•ì œ ë¦¬í”Œë¡œìš°
      void document.body.offsetHeight;
    }

    // í˜¸ìŠ¤íŠ¸ ë³€ê²½ ì´ë²¤íŠ¸
    socket.on('host-changed', (isNewHost) => {
      isHost = isNewHost;
      if (isHost) {
        console.log('í˜¸ìŠ¤íŠ¸ ê¶Œí•œ íšë“');
        
        // í˜¸ìŠ¤íŠ¸ê°€ ë˜ì—ˆì„ ë•Œ ê²Œì„ë£¸ì´ ìˆ¨ê²¨ì ¸ ìˆë‹¤ë©´ í‘œì‹œ
        if (document.getElementById('gameRoom').style.display === 'none') {
          console.log('í˜¸ìŠ¤íŠ¸ ê¶Œí•œ íšë“ ì‹œ ê²Œì„ë£¸ì´ ìˆ¨ê²¨ì ¸ ìˆì–´ í‘œì‹œë¡œ ë³€ê²½');
          document.getElementById('gameRoom').style.display = 'block';
        }
        
        document.getElementById('resetGameBtn').disabled = false;
        document.getElementById('resetRoomBtn').disabled = false;
        
        // í˜¸ìŠ¤íŠ¸ë©´ ë°´ ì»¨íŠ¸ë¡¤ í‘œì‹œ
        if (!gameStarted) {
          document.getElementById('banPhaseControls').style.display = 'flex';
        }
        
        // í˜¸ìŠ¤íŠ¸ ë³€ê²½ ì‹œ ì°¸ì—¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        hasJoined = true;
        localStorage.setItem('hasJoined', 'true');
        
        Toastify({
          text: "í˜¸ìŠ¤íŠ¸ ê¶Œí•œì´ ë¶€ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤!",
          duration: 1500,
          gravity: "top",
          position: "center",
          style: {
            background: "linear-gradient(to right, #00b09b, #96c93d)",
            color: "white",
            fontWeight: "bold",
            fontSize: "16px",
            padding: "15px",
            borderRadius: "5px"
          }
        }).showToast();
      } else {
        // í˜¸ìŠ¤íŠ¸ê°€ ì•„ë‹ˆë©´ ë°´ ì»¨íŠ¸ë¡¤ ìˆ¨ê¸°ê¸°
        document.getElementById('banPhaseControls').style.display = 'none';
      }
    });

    // ë°© ì´ˆê¸°í™” ë²„íŠ¼
    document.getElementById('resetRoomBtn').addEventListener('click', () => {
      const password = prompt('ë°©ì„ ì´ˆê¸°í™”í•˜ë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
      if (password) {
        socket.emit('reset-room', password);
      }
    });

    // ë°© ì´ˆê¸°í™” ì—ëŸ¬ ì²˜ë¦¬
    socket.on('reset-room-error', (message) => {
      Toastify({
        text: message,
        duration: 1500,
        gravity: "top",
        position: "center",
        style: {
          background: "linear-gradient(to right, #ff0000, #d32f2f)",
          color: "white",
          fontWeight: "bold",
          fontSize: "16px",
          padding: "15px",
          borderRadius: "5px"
        }
      }).showToast();
    });

    // ë°© ì´ˆê¸°í™”
    socket.on('room-reset', () => {
      Toastify({
        text: "ë°©ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.",
        duration: 3000,
        gravity: "top",
        position: "center",
        style: {
          background: "linear-gradient(to right, #ff0000, #d32f2f)",
          color: "white",
          fontWeight: "bold",
          fontSize: "16px",
          padding: "15px",
          borderRadius: "5px"
        }
      }).showToast();
      
      // ì ‘ì† ìƒíƒœ ì´ˆê¸°í™”
      hasJoined = false;
      localStorage.removeItem('hasJoined');
      
      // ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™”
      resetBanSlots();
      
      // 3ì´ˆ í›„ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
      setTimeout(() => {
        window.location.reload();
      }, 3000);
    });

    // ì±”í”¼ì–¸ í‘œì‹œ ì—…ë°ì´íŠ¸
    function updateChampionDisplay() {
      const seats = document.querySelectorAll('.seat.taken');
      seats.forEach(seat => {
        const playerName = seat.querySelector('.player-info div').textContent;
        if (playerName === socket.nickname) {
          const championDisplay = seat.querySelector('.champion-display') || 
                                document.createElement('div');
          championDisplay.className = 'champion-display';
          championDisplay.innerHTML = `<img src="/champions/${currentChampion}.png" alt="${currentChampion}">`;
          if (!seat.querySelector('.champion-display')) {
            seat.querySelector('.player-info').appendChild(championDisplay);
          }
        }
      });
    }

    // ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
    function updateChampionList(champions) {
      const championList = document.getElementById('championList');
      championList.innerHTML = '';
      
      if (!champions || champions.length === 0) {
        const emptyMessage = document.createElement('div');
        emptyMessage.className = 'empty-champion-list';
        emptyMessage.textContent = 'ì‚¬ìš© ê°€ëŠ¥í•œ ì±”í”¼ì–¸ì´ ì—†ìŠµë‹ˆë‹¤';
        championList.appendChild(emptyMessage);
        return;
      }
      
      // ê²Œì„ ëª¨ë“œ í™•ì¸ - ë°´ ëª¨ë“œì—ì„œëŠ” ë°´ëœ ì±”í”¼ì–¸ í‘œì‹œ ë¡œì§ ë³€ê²½
      const isBanPhaseActive = document.querySelector('.teams-container').classList.contains('ban-mode');
      const isGameStarted = gameStarted; // ì „ì—­ ë³€ìˆ˜ ì‚¬ìš©
      
      // ë°´ ëª¨ë“œì™€ ê²Œì„ ì‹œì‘ ì—¬ë¶€ì— ë”°ë¥¸ ì²˜ë¦¬
      if (isBanPhaseActive && !isGameStarted) {
        // ë°´ ë‹¨ê³„ì—ì„œëŠ” ë°´ëœ ì±”í”¼ì–¸ë§Œ í™•ì¸
        const myStatus = playerBanStatus[socket.id];
        const myBannedChampion = myStatus && myStatus.champion ? myStatus.champion : null;
        
        // ì±”í”¼ì–¸ ëª©ë¡ ìˆœíšŒí•˜ë©° ê·¸ë¦¬ë“œì— ì¶”ê°€
      champions.forEach(champion => {
          const item = document.createElement('div');
          item.className = 'champion-item';
          
          // ë‚´ê°€ ë°´í•œ ì±”í”¼ì–¸ë§Œ ë°´ í‘œì‹œ
          const isBanned = myBannedChampion === champion;
          
          if (isBanned) {
            item.classList.add('banned');
          }
          
          // í•œê¸€ ì´ë¦„ ì¶”ê°€
          const koreanName = getKoreanName(champion);
          item.innerHTML = `<img src="/champions/${champion}.png" alt="${champion}" title="${koreanName}">`;
          
          // ë°´ ì„ íƒ ì´ë²¤íŠ¸
          if (!isBanned) {
            item.addEventListener('click', () => {
              // ì´ì „ì— ì„ íƒí•œ ì±”í”¼ì–¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
              const prevSelected = document.querySelector('.champion-item.selected');
              if (prevSelected) {
                prevSelected.classList.remove('selected');
              }
              
              // í˜„ì¬ ì±”í”¼ì–¸ ì„ íƒ í‘œì‹œ
              item.classList.add('selected');
              
              // ì„ íƒí•œ ì±”í”¼ì–¸ ì €ì¥
              selectedBanChampion = champion;
              
              // ë°´ í™•ì • ë²„íŠ¼ í™œì„±í™”
              document.getElementById('banConfirmBtn').disabled = false;
            });
          }
          
          championList.appendChild(item);
        });
      } else {
        // ê²Œì„ ì‹œì‘ í›„ì—ëŠ” ìŠ¤ì™‘ ê°€ëŠ¥í•œ ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸
        champions.forEach(champion => {
          const item = document.createElement('div');
          item.className = 'champion-item';
          
          // í•œê¸€ ì´ë¦„ ì¶”ê°€
          const koreanName = getKoreanName(champion);
          item.innerHTML = `<img src="/champions/${champion}.png" alt="${champion}" title="${koreanName}">`;
          
          // ì±”í”¼ì–¸ ìŠ¤ì™‘ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
          item.addEventListener('click', () => {
            // ë‚´ í˜„ì¬ ì±”í”¼ì–¸ê³¼ ìŠ¤ì™‘
            console.log('ì±”í”¼ì–¸ ìŠ¤ì™‘ ìš”ì²­:', champion);
            socket.emit('swap-champion', champion);
          });
          
          championList.appendChild(item);
        });
      }
    }

    // ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸
    socket.on('champion-list-update', (champions) => {
      updateChampionList(champions);
    });

    // ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘
    socket.on('start-countdown', (duration) => {
      // ê¸°ì¡´ íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ ì´ˆê¸°í™”
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }

      const countdownElement = document.getElementById('countdown');
      countdownElement.style.display = 'block';
      
      let timeLeft = duration;
      countdownInterval = setInterval(() => {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        countdownElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        
        if (timeLeft <= 0) {
          clearInterval(countdownInterval);
          countdownInterval = null;
          countdownElement.textContent = 'ì‹œê°„ ì¢…ë£Œ!';
          countdownElement.style.color = '#ff0000';
          
          // ë¦¬ë¡¤ ë²„íŠ¼ ë¹„í™œì„±í™”
          document.getElementById('rerollBtn').disabled = true;
          
          // ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ ë¹„í™œì„±í™”
          const championItems = document.querySelectorAll('.champion-item');
          championItems.forEach(item => {
            item.style.pointerEvents = 'none';
            item.style.opacity = '0.5';
          });
        }
        timeLeft--;
      }, 1000);
    });

    // ì¹´ìš´íŠ¸ë‹¤ìš´ ì´ˆê¸°í™”
    socket.on('countdown-reset', () => {
      // ê¸°ì¡´ íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ ì´ˆê¸°í™”
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }

      const countdownElement = document.getElementById('countdown');
      countdownElement.style.display = 'none';
      countdownElement.textContent = '';
      countdownElement.style.color = '#ff0000';
      
      // ë¦¬ë¡¤ ë²„íŠ¼ ì´ˆê¸°í™”
      const rerollBtn = document.getElementById('rerollBtn');
      rerollBtn.disabled = true;
      
      // ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
      const championList = document.getElementById('championList');
      championList.innerHTML = '';
      
      // ê²Œì„ ìƒíƒœ ë©”ì‹œì§€ ì´ˆê¸°í™”
      const gameStatusMessage = document.getElementById('gameStatusMessage');
      gameStatusMessage.textContent = 'ê²Œì„ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. íŒ€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.';
    });

    // ì±”í”¼ì–¸ ìŠ¤ì™‘ ì„±ê³µ ì´ë²¤íŠ¸
    socket.on('champion-swapped', (data) => {
      const { oldChampion, newChampion } = data;
      currentChampion = newChampion;
      updateChampionDisplay();
    });

    // í…Œë§ˆ ì „í™˜ ê¸°ëŠ¥
    const themeSwitch = document.getElementById('themeSwitch');

    function toggleTheme() {
      isDarkTheme = !isDarkTheme;
      document.documentElement.setAttribute('data-theme', isDarkTheme ? 'dark' : 'light');
      themeSwitch.textContent = isDarkTheme ? 'ğŸŒ™' : 'ğŸŒ';
      
      // ì¿ í‚¤ì— í…Œë§ˆ ì„¤ì • ì €ì¥ (30ì¼ ë™ì•ˆ ìœ ì§€)
      setCookie("darkMode", isDarkTheme.toString(), 30);
      
      // í…Œë§ˆ ë³€ê²½ ì•Œë¦¼
      Toastify({
        text: `${isDarkTheme ? 'ë‹¤í¬' : 'ë¼ì´íŠ¸'} ëª¨ë“œë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤`,
        duration: 1500,
        gravity: "top",
        position: "center",
        style: {
          background: isDarkTheme ? 
            "linear-gradient(to right, #1a1a2e, #0a0a1e)" : 
            "linear-gradient(to right, #00b09b, #96c93d)",
          color: "white",
          fontWeight: "bold",
          fontSize: "16px",
          padding: "15px",
          borderRadius: "5px"
        }
      }).showToast();
    }

    themeSwitch.addEventListener('click', toggleTheme);

    // ëœë¤ ë°°ì • ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.getElementById('randomAssignBtn').addEventListener('click', () => {
      if (isHost) {
        socket.emit('random-assign-teams');
        
        // ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ
        Toastify({
          text: "í”Œë ˆì´ì–´ë“¤ì„ ëœë¤ìœ¼ë¡œ íŒ€ì— ë°°ì •í•©ë‹ˆë‹¤!",
          duration: 3000,
          gravity: "top",
          position: "center",
          style: {
            background: "linear-gradient(to right, #8E2DE2, #4A00E0)",
            color: "white",
            fontWeight: "bold",
            fontSize: "16px",
            padding: "15px",
            borderRadius: "5px"
          }
        }).showToast();
      }
    });

    // ë¦¬ë¡¤ ë³´ë„ˆìŠ¤ ì•Œë¦¼
    socket.on('reroll-bonus', (data) => {
      // ì„œë²„ì—ì„œ ì „ì†¡í•œ ì—…ë°ì´íŠ¸ëœ í†µê³„ ê°’ë§Œ ì‚¬ìš©
      playerStats.rerollCount = data.newCount;
      // ìŠ¹íŒ¨ ì²˜ë¦¬ëŠ” ì„œë²„ì—ì„œ ì´ë¯¸ ì²˜ë¦¬ë˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” í†µê³„ë§Œ ì—…ë°ì´íŠ¸
      savePlayerStats();
      
      Toastify({
        text: data.message + ` (í˜„ì¬: ${data.newCount})`,
        duration: 3000,
        gravity: "bottom",
        position: "right",
        style: {
          background: "linear-gradient(to right, #FF9800, #FF5722)",
          color: "white",
          fontWeight: "bold",
          fontSize: "14px",
          padding: "12px",
          borderRadius: "5px"
        }
      }).showToast();
    });
    // ê³µì§€ì‚¬í•­ í‘œì‹œ í•¨ìˆ˜
    function showNotice() {
      // ì´ë¯¸ ë³¸ ê³µì§€ì‚¬í•­ì¸ì§€ í™•ì¸
      const noticeShown = getCookie("noticeVersion");
      if (noticeShown === NOTICE_VERSION) {
        return; // ì´ë¯¸ í˜„ì¬ ë²„ì „ì˜ ê³µì§€ì‚¬í•­ì„ ë´¤ìœ¼ë©´ í‘œì‹œí•˜ì§€ ì•ŠìŒ
      }

      // ëª¨ë‹¬ ìƒì„±
      const modal = document.createElement('div');
      modal.className = 'notice-modal';
      modal.innerHTML = `
        <div class="notice-modal-content">
          <div class="notice-title">ì—…ë°ì´íŠ¸ ì•ˆë‚´ <small>(2025.05.11)</small></div>
          <div class="notice-content">
            <div class="notice-update-item">
              <b>ìë¦¬ ì €ì¥</b>: ìë¦¬ ì €ì¥ ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì–´ ì•ŒíŠ¸íƒ­ì‹œ ì—°ê²°ì´ ëŠê²¨ë„ ì¬ì ‘ì†ì‹œ ê¸°ì¡´ ìë¦¬ì— ë°°ì¹˜ë©ë‹ˆë‹¤.
            </div>
            <div class="notice-update-item">
              <b>ë¦¬ë¡¤ ì§€ê¸‰ ì‹œìŠ¤í…œ ë³€ê²½</b>: ê¸°ì¡´ì— íŒ¨ë°°íŒ€ì—ê²Œë§Œ ì§€ê¸‰ë˜ì—ˆë˜ ë¦¬ë¡¤ ë³´ë„ˆìŠ¤ê°€ ìŠ¹ë¦¬íŒ€ì—ê²Œ 1íšŒ, íŒ¨ë°°íŒ€ì—ê²Œ 2íšŒ ì§€ê¸‰ë©ë‹ˆë‹¤.
            </div>
            <div class="notice-update-item">
              <b>ì´ˆê¸°í™”</b>: ë¦¬ë¡¤ ì§€ê¸‰ ì‹œìŠ¤í…œ ë³€ê²½ìœ¼ë¡œ ì¸í•´ í”Œë ˆì´ì–´ ì •ë³´ë¥¼ ëª¨ë‘ ì´ˆê¸°í™”í–ˆìŠµë‹ˆë‹¤.
            </div>
          </div>
          <div class="notice-buttons">
            <button class="notice-dont-show">ë‹¤ì‹œ ë³´ì§€ ì•Šê¸°</button>
            <button class="notice-close">ë‹«ê¸°</button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
      modal.querySelector('.notice-close').addEventListener('click', () => {
        document.body.removeChild(modal);
      });

      modal.querySelector('.notice-dont-show').addEventListener('click', () => {
        setCookie("noticeVersion", NOTICE_VERSION, 90); // 90ì¼ ë™ì•ˆ ì €ì¥
        document.body.removeChild(modal);
      });
    }

    // ë¦¬ë¡¤ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    document.getElementById('rerollBtn').addEventListener('click', () => {
      const rerollBtn = document.getElementById('rerollBtn');
      if (!rerollBtn.disabled && playerStats.rerollCount > 0) {
        socket.emit('request-reroll');
        // ë¡œì»¬ ë¦¬ë¡¤ ì¹´ìš´íŠ¸ëŠ” ì„œë²„ì˜ ì‘ë‹µì„ í†µí•´ ì—…ë°ì´íŠ¸ (ì¤‘ë³µ ë°©ì§€)
      } else {
        // ë¦¬ë¡¤ ë²„íŠ¼ì´ ë¹„í™œì„±í™”ëœ ìƒíƒœì—ì„œ í´ë¦­í–ˆì„ ë•Œë§Œ ì•Œë¦¼ í‘œì‹œ
        Toastify({
          text: "ë¦¬ë¡¤ íšŸìˆ˜ê°€ ëª¨ë‘ ì†Œì§„ë˜ì—ˆìŠµë‹ˆë‹¤!",
          duration: 1500,
          gravity: "bottom",
          position: "right",
          style: {
            background: "linear-gradient(to right, #f44336, #d32f2f)",
            color: "white",
            fontWeight: "bold",
            fontSize: "14px",
            padding: "12px",
            borderRadius: "5px"
          }
        }).showToast();
      }
    });
    
    // ê²Œì„ ì‹œì‘ ë²„íŠ¼
    document.getElementById('startGameBtn').addEventListener('click', () => {
      if (isHost) {
        // ê²Œì„ ëª¨ë“œ ì„ íƒ ëª¨ë‹¬ í‘œì‹œ
        document.getElementById('modeSelectModal').style.display = 'flex';
      }
    });

    // ì¼ë°˜ ëª¨ë“œ ë²„íŠ¼ í´ë¦­
    document.getElementById('normalModeBtn').addEventListener('click', () => {
      document.getElementById('modeSelectModal').style.display = 'none';
      isBanMode = false;
      socket.emit('start-game', { mode: 'normal' });
    });

    // ë°´ ëª¨ë“œ ë²„íŠ¼ í´ë¦­
    document.getElementById('banModeBtn').addEventListener('click', () => {
      document.getElementById('modeSelectModal').style.display = 'none';
      isBanMode = true;
      // ëª¨ë“  ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™”
      resetBanSlots();
      socket.emit('start-game', { mode: 'ban' });
    });

    // ë°´ ëª¨ë“œ ì‹œì‘ ì´ë²¤íŠ¸ ì²˜ë¦¬
    socket.on('start-ban-phase', (data) => {
      // ë°´ ë‹¨ê³„ ì‹œì‘
      document.getElementById('bannedChampionsTitle').textContent = 'ë°´í•  ì±”í”¼ì–¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”';
      
      // ê²Œì„ ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸ - ë°´ ë‹¨ê³„ ì•ˆë‚´
      const gameStatusMessage = document.getElementById('gameStatusMessage');
      if (gameStatusMessage) {
        gameStatusMessage.textContent = 'ë°´ ë‹¨ê³„: ë°´í•  ì±”í”¼ì–¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”!';
        gameStatusMessage.style.color = '#f44336'; // ë°´ ë‹¨ê³„ì—ì„œëŠ” ë¶‰ì€ìƒ‰ìœ¼ë¡œ í‘œì‹œ
      }
      
      // ë°´ ë‹¨ê³„ ì¢…ë£Œ í”Œë˜ê·¸ ì´ˆê¸°í™”
      banPhaseEnded = false;
      
      // ë°´ ëª¨ë“œë¡œ UI ë³€ê²½
      const bannedChampionsSection = document.getElementById('bannedChampionsSection');
      bannedChampionsSection.classList.add('ban-mode');
      bannedChampionsSection.style.display = 'block'; // ë°´ ë‹¨ê³„ì—ì„œëŠ” ë°´ ì„¹ì…˜ í‘œì‹œ
      
      // íŒ€ ì»¨í…Œì´ë„ˆì—ì„œ no-ban í´ë˜ìŠ¤ ì œê±°
      const teamsContainer = document.querySelector('.teams-container');
      teamsContainer.classList.remove('no-ban');
      teamsContainer.classList.add('ban-mode');
      
      // í”Œë ˆì´ì–´ ë°´ ìƒíƒœ ì´ˆê¸°í™”
      playerBanStatus = data.players;
      
      // ë‚´ íŒ€ í™•ì¸ - ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ ì‹œë„
      let myTeam = socket.team; // ê¸°ë³¸ê°’ìœ¼ë¡œ ì†Œì¼“ì— ì €ì¥ëœ íŒ€ ì‚¬ìš©
      
      // í”Œë ˆì´ì–´ ë°´ ìƒíƒœì—ì„œ ë‚´ íŒ€ í™•ì¸
      if (playerBanStatus[socket.id] && playerBanStatus[socket.id].team) {
        myTeam = playerBanStatus[socket.id].team;
      }
      
      // ê²Œì„ ìƒíƒœì—ì„œ ë‚´ íŒ€ í™•ì¸
      if (data.state) {
        // team1ì—ì„œ í™•ì¸
        const team1Player = data.state.team1.find(p => p && p.id === socket.id);
        if (team1Player) {
          myTeam = 'team1';
        }
        
        // team2ì—ì„œ í™•ì¸
        const team2Player = data.state.team2.find(p => p && p.id === socket.id);
        if (team2Player) {
          myTeam = 'team2';
        }
      }
      
      console.log('ë‚´ íŒ€ í™•ì¸:', myTeam, 'ì†Œì¼“ ID:', socket.id);
      
      // ë‚´ íŒ€ì— í´ë˜ìŠ¤ ì¶”ê°€ (CSS ì‹ë³„ìš©)
      const teams = document.querySelectorAll('.team');
      teams.forEach((team, index) => {
        // index 0 = íŒ€ 1, index 1 = íŒ€ 2
        const teamType = index === 0 ? 'team1' : 'team2';
        if (teamType === myTeam) {
          team.classList.add('my-team');
        } else {
          team.classList.remove('my-team');
        }
      });
      
      // ì¤‘ì•™ ì„¹ì…˜ ì»¨íŠ¸ë¡¤ í‘œì‹œ
      document.getElementById('playerBanStatus').style.display = 'flex';
      document.getElementById('banTimerDisplay').style.display = 'block';
      
      // í˜¸ìŠ¤íŠ¸ ì—¬ë¶€ì— ìƒê´€ì—†ì´ ëª¨ë“  í”Œë ˆì´ì–´ì—ê²Œ ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
      // ë‹¨, ë°´ í™•ì • ë²„íŠ¼ì€ ê°ì í•„ìš”í•¨
      document.getElementById('banPhaseControls').style.display = 'block';
      document.getElementById('bannedChampions').style.display = 'none';
      
      // ë°´ ë‹¨ê³„ì—ì„œë„ ì±”í”¼ì–¸ ë¦¬ìŠ¤íŠ¸ ì„¹ì…˜ í‘œì‹œ ìœ ì§€
      document.querySelector('.champion-list').style.display = 'block';
      
      updatePlayerBanStatus();
      
      // ëª¨ë“  ì±”í”¼ì–¸ í‘œì‹œ
      renderChampionGrid();
      
      // ë°´ íƒ€ì´ë¨¸ ì‹œì‘ (1ë¶„ 30ì´ˆ)
      startBanTimer(90);
      
      // ëª¨ë“  ìë¦¬ ì—…ë°ì´íŠ¸ - ë°´ ëª¨ë“œì—ì„œëŠ” ìë¦¬ ì´ë™ ë²„íŠ¼ ë¹„í™œì„±í™”
      const state = data.state;
      if (state) {
        updateSeats(state.team1, 'team1Seats');
        updateSeats(state.team2, 'team2Seats');
        updateSeats(state.waiting, 'waitingSeats');
        
        // í˜„ì¬ íŒ€ ë°´ ìƒíƒœ í‘œì‹œ - ìê¸° íŒ€ë§Œ
        if (myTeam === 'team1' && state.team1Bans && state.team1Bans.length > 0) {
          updateTeamBanSlots('team1', state.team1Bans);
        } else if (myTeam === 'team2' && state.team2Bans && state.team2Bans.length > 0) {
          updateTeamBanSlots('team2', state.team2Bans);
        }
      }
      
      // ë°´ ë‹¨ê³„ì—ì„œëŠ” ê²Œì„ ì‹œì‘ ë²„íŠ¼ ë¹„í™œì„±í™”
      if (isHost) {
        document.getElementById('startGameBtn').disabled = true;
      }
    });

    // ë°´ ë‹¨ê³„ ì™„ë£Œ ì´ë²¤íŠ¸
    socket.on('ban-phase-complete', (data) => {
      // ë°´ ë‹¨ê³„ ì¢…ë£Œ í”Œë˜ê·¸ ì„¤ì •
      banPhaseEnded = true;
      
      // ê²Œì„ ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸ - ë°´ ë‹¨ê³„ ì¢…ë£Œ í‘œì‹œ
      const gameStatusMessage = document.getElementById('gameStatusMessage');
      if (gameStatusMessage) {
        gameStatusMessage.textContent = 'ë°´ ë‹¨ê³„ ì™„ë£Œ! ê²Œì„ì´ ì‹œì‘ë©ë‹ˆë‹¤.';
        gameStatusMessage.style.color = '#4CAF50'; // ë°´ ë‹¨ê³„ ì¢…ë£Œ í›„ ë…¹ìƒ‰ìœ¼ë¡œ í‘œì‹œ
      }
      
      // ë°´ íƒ€ì´ë¨¸ ì •ì§€
      if (banTimerInterval) {
        clearInterval(banTimerInterval);
        banTimerInterval = null;
      }
      
      // ì´ì œ ë°´ ë‹¨ê³„ê°€ ëë‚¬ìœ¼ë¯€ë¡œ íŒ€ë³„ ë°´ ì±”í”¼ì–¸ ì—…ë°ì´íŠ¸ (ì´ì œ ëª¨ë“  ì •ë³´ í‘œì‹œ)
      if (data.team1Bans && data.team1Bans.length > 0) {
        updateTeamBanSlots('team1', data.team1Bans);
      }
      if (data.team2Bans && data.team2Bans.length > 0) {
        updateTeamBanSlots('team2', data.team2Bans);
      }
      
      // ë°´ ì„¹ì…˜ ì›ë˜ ìƒíƒœë¡œ ë³µì›
      const bannedChampionsSection = document.getElementById('bannedChampionsSection');
      bannedChampionsSection.classList.remove('ban-mode');
      bannedChampionsSection.style.display = 'none'; // ë°´ ë‹¨ê³„ ì™„ë£Œ í›„ ë°´ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
      
      // íŒ€ ì»¨í…Œì´ë„ˆì— no-ban í´ë˜ìŠ¤ ì¶”ê°€
      const teamsContainer = document.querySelector('.teams-container');
      teamsContainer.classList.add('no-ban');
      teamsContainer.classList.remove('ban-mode');
      
      // íŒ€ì—ì„œ my-team í´ë˜ìŠ¤ ì œê±°
      document.querySelectorAll('.team').forEach(team => {
        team.classList.remove('my-team');
      });
      
      document.getElementById('bannedChampionsTitle').textContent = 'ë°´ ì±”í”¼ì–¸';
      document.getElementById('playerBanStatus').style.display = 'none';
      document.getElementById('banTimerDisplay').style.display = 'none';
      document.getElementById('banPhaseControls').style.display = 'none';
      document.getElementById('bannedChampions').style.display = 'grid';
      
      // ì „ì²´ ë°´ ì±”í”¼ì–¸ ëª©ë¡ ì—…ë°ì´íŠ¸
      bannedChampions = data.allBannedChampions;
      updateBannedChampions(); // ì¤‘ì•™ ë°´ ì±”í”¼ì–¸ ì„¹ì…˜ ì—…ë°ì´íŠ¸
      
      // ê²Œì„ ì‹œì‘ ì•Œë¦¼
      Toastify({
        text: "ë°´ ë‹¨ê³„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤!",
        duration: 3000,
        gravity: "top",
        position: "center",
        style: {
          background: "linear-gradient(to right, #4CAF50, #2E7D32)",
          color: "white",
          fontWeight: "bold",
          fontSize: "16px",
          padding: "15px",
          borderRadius: "5px"
        }
      }).showToast();
    });
    
    // ë°´ íƒ€ì´ë¨¸ ì‹œì‘ í•¨ìˆ˜
    function startBanTimer(duration) {
      let timer = duration;
      const timerDisplay = document.getElementById('banTimerDisplay');
      const gameStatusMessage = document.getElementById('gameStatusMessage');
      
      // ì´ì „ íƒ€ì´ë¨¸ê°€ ìˆë‹¤ë©´ ì´ˆê¸°í™”
      if (banTimerInterval) {
        clearInterval(banTimerInterval);
      }
      
      updateTimerDisplay();
      
      banTimerInterval = setInterval(() => {
        timer--;
        updateTimerDisplay();
        
        // íƒ€ì´ë¨¸ ê²½ê³¼ ì‹œê°„ì— ë”°ë¼ ê²Œì„ ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
        if (timer <= 10 && gameStatusMessage) {
          gameStatusMessage.textContent = `ë°´ ë‹¨ê³„: ì„œë‘˜ëŸ¬ ë°´í•  ì±”í”¼ì–¸ì„ ì„ íƒí•˜ì„¸ìš”! (${timer}ì´ˆ ë‚¨ìŒ)`;
          gameStatusMessage.style.color = timer % 2 === 0 ? '#ff0000' : '#ff9800'; // ê¹œë¹¡ì´ëŠ” íš¨ê³¼
        }
        
        if (timer <= 0) {
          clearInterval(banTimerInterval);
          
          // íƒ€ì´ë¨¸ ì¢…ë£Œ ì‹œ ê²Œì„ ìƒíƒœ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
          if (gameStatusMessage) {
            gameStatusMessage.textContent = 'ë°´ ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë°´ ì²˜ë¦¬ ì¤‘...';
            gameStatusMessage.style.color = '#ff9800';
          }
          
          // ì‹œê°„ì´ ë‹¤ ëëŠ”ë° ë°´ì„ ì„ íƒí•˜ì§€ ì•Šì•˜ë‹¤ë©´ ìë™ìœ¼ë¡œ ëœë¤ ë°´
          if (!selectedBanChampion) {
            const availableChampions = getAvailableBanChampions();
            if (availableChampions.length > 0) {
              const randomIndex = Math.floor(Math.random() * availableChampions.length);
              selectedBanChampion = availableChampions[randomIndex];
              socket.emit('ban-champion', {
                champion: selectedBanChampion,
                auto: true
              });
            }
          }
        }
      }, 1000);
      
      function updateTimerDisplay() {
        const minutes = Math.floor(timer / 60);
        const seconds = timer % 60;
        timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        
        // 10ì´ˆ ì´í•˜ë¡œ ë‚¨ìœ¼ë©´ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ê¹œë¹¡ì´ê²Œ
        if (timer <= 10) {
          timerDisplay.style.color = timer % 2 === 0 ? '#f44336' : '#ff9800';
        } else {
          timerDisplay.style.color = '#f44336';
        }
      }
    }

    // ì‚¬ìš© ê°€ëŠ¥í•œ ë°´ ì±”í”¼ì–¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
    function getAvailableBanChampions() {
      // ì´ë¯¸ ë°´ëœ ì±”í”¼ì–¸ë“¤ì„ ì œì™¸í•œ ëª©ë¡ ë°˜í™˜
      const allBannedChampions = Object.values(playerBanStatus)
                                      .filter(status => status.champion)
                                      .map(status => status.champion);
      
      return champions.filter(champion => !allBannedChampions.includes(champion));
    }

    // ì±”í”¼ì–¸ ê·¸ë¦¬ë“œ ë Œë”ë§
    function renderChampionGrid() {
      const grid = document.getElementById('championGrid');
      grid.innerHTML = '';
      
      // ë‚´ ì •ë³´ì™€ ë°´í•œ ì±”í”¼ì–¸ í™•ì¸
      const myStatus = playerBanStatus[socket.id];
      const myTeam = myStatus ? myStatus.team : socket.team;
      const myBannedChampion = myStatus && myStatus.champion ? myStatus.champion : null;
      
      // íŒ€ë³„ë¡œ ì´ë¯¸ ë°´í•œ ì±”í”¼ì–¸ ëª©ë¡ êµ¬ì„±
      const myTeamBans = [];
      const myTeamSelecting = [];
      const enemyTeamBans = [];
      
      Object.values(playerBanStatus).forEach(status => {
        if (status.team === myTeam) {
          if (status.champion) {
            myTeamBans.push(status.champion);
          } else if (status.selectingChampion) {
            myTeamSelecting.push(status.selectingChampion);
          }
        } else if (status.champion) {
          enemyTeamBans.push(status.champion);
        }
      });
      
      // ì±”í”¼ì–¸ ëª©ë¡ ìˆœíšŒí•˜ë©° ê·¸ë¦¬ë“œì— ì¶”ê°€
      champions.forEach(champion => {
        const item = document.createElement('div');
        item.className = 'champion-item';
        
        // ë‚´ê°€ ë°´í•œ ì±”í”¼ì–¸ ë˜ëŠ” ê°™ì€ íŒ€ì´ ì´ë¯¸ ë°´í•œ ì±”í”¼ì–¸ì€ ë°´ í‘œì‹œ
        const isBannedByMe = myBannedChampion === champion;
        const isBannedByMyTeam = myTeamBans.includes(champion);
        const isSelectedByMyTeam = myTeamSelecting.includes(champion);
        
        if (isBannedByMe || isBannedByMyTeam) {
          item.classList.add('banned');
        } else if (isSelectedByMyTeam) {
          item.classList.add('selected-by-team');
        }
        
        // í•œê¸€ ì´ë¦„ ì¶”ê°€
        const koreanName = getKoreanName(champion);
        item.innerHTML = `<img src="/champions/${champion}.png" alt="${champion}" title="${koreanName}">`;
        
        // ë°´ ì„ íƒ ì´ë²¤íŠ¸ - ë‚´ê°€ ì´ë¯¸ ë°´í–ˆê±°ë‚˜ ê°™ì€ íŒ€ì´ ë°´í•œ ì±”í”¼ì–¸ì€ ì„ íƒ ë¶ˆê°€
        if (!isBannedByMe && !isBannedByMyTeam) {
          item.addEventListener('click', () => {
            // ì´ì „ì— ì„ íƒí•œ ì±”í”¼ì–¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
            const prevSelected = document.querySelector('.champion-item.selected');
            if (prevSelected) {
              prevSelected.classList.remove('selected');
            }
            
            // í˜„ì¬ ì±”í”¼ì–¸ ì„ íƒ í‘œì‹œ
            item.classList.add('selected');
            
            // ì„ íƒí•œ ì±”í”¼ì–¸ ì €ì¥
            selectedBanChampion = champion;
            
            // ì„ íƒ ì¤‘ì¸ ì±”í”¼ì–¸ ì •ë³´ ì„œë²„ì— ì „ì†¡ (ì•„ì§ í™•ì •ì€ ì•„ë‹˜)
            socket.emit('selecting-ban-champion', champion);
            
            // ë°´ í™•ì • ë²„íŠ¼ í™œì„±í™”
            document.getElementById('banConfirmBtn').disabled = false;
          });
        } else {
          // ê°™ì€ íŒ€ì´ ì´ë¯¸ ë°´í•œ ì±”í”¼ì–¸ì€ ì„ íƒ ë¶ˆê°€
          item.style.pointerEvents = 'none';
        }
        
        grid.appendChild(item);
      });
    }

    // í”Œë ˆì´ì–´ ë°´ ìƒíƒœ ì—…ë°ì´íŠ¸
    function updatePlayerBanStatus() {
      const container = document.getElementById('playerBanStatus');
      container.innerHTML = '';
      
      // ë‚´ íŒ€ ì •ë³´ í™•ì¸
      const myStatus = playerBanStatus[socket.id];
      const myTeam = myStatus ? myStatus.team : socket.team;
      
      // í”Œë ˆì´ì–´ë¥¼ íŒ€ë³„ë¡œ ë¶„ë¥˜
      const myTeamPlayers = [];
      
      Object.entries(playerBanStatus).forEach(([playerId, data]) => {
        if (data.team === myTeam) {
          myTeamPlayers.push({playerId, ...data});
        }
      });
      
      // ë‚´ íŒ€ ì„¹ì…˜ ì œëª© ì¶”ê°€
      const myTeamHeader = document.createElement('div');
      myTeamHeader.className = 'ban-team-header';
      myTeamHeader.textContent = myTeam === 'team1' ? 'íŒ€ 1 ë°´ í˜„í™©' : 'íŒ€ 2 ë°´ í˜„í™©';
      container.appendChild(myTeamHeader);
      
      // ë‚´ íŒ€ í”Œë ˆì´ì–´ ìƒíƒœ í‘œì‹œ
      myTeamPlayers.forEach(player => {
        const isCurrentPlayer = player.playerId === socket.id;
        const item = document.createElement('div');
        item.className = `player-ban-item ${player.champion ? 'completed' : 'selecting'}`;
        
        let displayName = player.nickname;
        if (isCurrentPlayer) {
          displayName += ' (ë‚˜)';
        }
        
        let banStatus = '';
        if (player.champion) {
          // ë‚´ íŒ€ì´ ë°´í•œ ì±”í”¼ì–¸ì€ í•­ìƒ í‘œì‹œ
          const championName = player.champion;
          const koreanName = getKoreanName(championName);
          banStatus = `<div class="player-ban-image" title="${koreanName}"><img src="/champions/${championName}.png" alt="${championName}"></div>`;
        } else if (player.selectingChampion) {
          // ì„ íƒ ì¤‘ì¸ ì±”í”¼ì–¸ì´ ìˆìœ¼ë©´ í‘œì‹œ
          const championName = player.selectingChampion;
          const koreanName = getKoreanName(championName);
          banStatus = `<div class="player-ban-image" title="${koreanName} (ì„ íƒ ì¤‘)" style="opacity:0.7;"><img src="/champions/${championName}.png" alt="${championName}"></div>`;
        } else {
          // ì•„ë¬´ê²ƒë„ ì„ íƒí•˜ì§€ ì•Šì€ ê²½ìš° "ì„ íƒ ì¤‘" í‘œì‹œ
          banStatus = `<span class="selecting-status">ì„ íƒ ì¤‘...</span>`;
        }
        
        item.innerHTML = `
          <span>${displayName}</span>
          ${banStatus}
        `;
        
        container.appendChild(item);
      });
      
      // ìƒëŒ€íŒ€ ì„¹ì…˜ì€ í‘œì‹œí•˜ì§€ ì•ŠìŒ (ì™„ì „íˆ ì œê±°)
    }

    // ë°´ í™•ì • ë²„íŠ¼ í´ë¦­
    document.getElementById('banConfirmBtn').addEventListener('click', () => {
      if (selectedBanChampion) {
        socket.emit('ban-champion', {
          champion: selectedBanChampion,
          auto: false
        });
        
        // ë²„íŠ¼ ë¹„í™œì„±í™”
        document.getElementById('banConfirmBtn').disabled = true;
        
        // ì„ íƒ ì¤‘ì¸ ìƒíƒœ ì´ˆê¸°í™”
        socket.emit('selecting-ban-champion', null);
      }
    });

    // ë°´ í™•ì • ì‘ë‹µ ì´ë²¤íŠ¸ ì²˜ë¦¬
    socket.on('ban-confirmed', (data) => {
      // í”Œë ˆì´ì–´ ë°´ ìƒíƒœ ì—…ë°ì´íŠ¸
      if (data.playerId && playerBanStatus[data.playerId]) {
        // í•´ë‹¹ í”Œë ˆì´ì–´ì˜ ë°´ ìƒíƒœ ì—…ë°ì´íŠ¸
        playerBanStatus[data.playerId].champion = data.champion;
        playerBanStatus[data.playerId].selectingChampion = null;
        
        // ë‚˜ì˜ ë°´ì´ë¼ë©´ ì„ íƒ ì´ˆê¸°í™”
        if (data.playerId === socket.id) {
          selectedBanChampion = null;
          
          // ì„ íƒëœ ì±”í”¼ì–¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
          const selectedChamp = document.querySelector('.champion-item.selected');
          if (selectedChamp) {
            selectedChamp.classList.remove('selected');
          }
          
          // í† ìŠ¤íŠ¸ ì•Œë¦¼ í‘œì‹œ
          Toastify({
            text: data.auto ? 
                  `ì‹œê°„ ì´ˆê³¼ë¡œ ${getKoreanName(data.champion)} ì±”í”¼ì–¸ì´ ìë™ ë°´ ë˜ì—ˆìŠµë‹ˆë‹¤!` : 
                  `${getKoreanName(data.champion)} ì±”í”¼ì–¸ì„ ë°´í–ˆìŠµë‹ˆë‹¤!`,
            duration: 3000,
            gravity: "top",
            position: "center",
            style: {
              background: data.auto ? 
                        "linear-gradient(to right, #ff9800, #f57c00)" : 
                        "linear-gradient(to right, #f44336, #d32f2f)",
              color: "white",
              fontWeight: "bold",
              fontSize: "14px",
              padding: "12px",
              borderRadius: "5px"
            }
          }).showToast();
        }
        
        // UI ì—…ë°ì´íŠ¸
        updatePlayerBanStatus();
        renderChampionGrid();
      }
    });

    // ë°´ ê²€ìƒ‰ ì…ë ¥ ì²˜ë¦¬
    document.getElementById('banSearchInput').addEventListener('input', (e) => {
      const searchTerm = e.target.value.toLowerCase();
      
      // ëª¨ë“  ì±”í”¼ì–¸ ì•„ì´í…œ ìˆœíšŒí•˜ë©° ê²€ìƒ‰ì–´ì— ë§ëŠ” ê²ƒë§Œ í‘œì‹œ
      const items = document.querySelectorAll('.champion-item');
      items.forEach(item => {
        const championNameEnglish = item.querySelector('img').alt;
        const championNameKorean = getKoreanName(championNameEnglish).toLowerCase();
        
        // ì˜ë¬¸ ì´ë¦„ì´ë‚˜ í•œê¸€ ì´ë¦„ì— ê²€ìƒ‰ì–´ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ í‘œì‹œ
        if (championNameEnglish.toLowerCase().includes(searchTerm) || 
            championNameKorean.includes(searchTerm) || 
            searchTerm === '') {
          item.style.display = '';
        } else {
          item.style.display = 'none';
        }
      });
    });

    // ë°´ ì±”í”¼ì–¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateBannedChampions() {
      const bannedList = document.getElementById('bannedChampions');
      bannedList.innerHTML = '';
      
      if (!bannedChampions || bannedChampions.length === 0) {
        const emptyMessage = document.createElement('div');
        emptyMessage.className = 'empty-champion-list';
        emptyMessage.textContent = 'ë°´ëœ ì±”í”¼ì–¸ì´ ì—†ìŠµë‹ˆë‹¤';
        bannedList.appendChild(emptyMessage);
        return;
      }
      
      bannedChampions.forEach(champion => {
        const bannedChampion = document.createElement('div');
        bannedChampion.className = 'banned-champion';
        bannedChampion.innerHTML = `
          <img src="/champions/${champion}.png" alt="${champion}" title="${champion}">
        `;
        bannedList.appendChild(bannedChampion);
      });
    }

    // íŒ€ ë°´ ìŠ¬ë¡¯ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateTeamBanSlots(team, bannedChampions) {
      if (!bannedChampions || !team) return;
      
      // ë°´ ìŠ¬ë¡¯ ì„ íƒ (íŒ€ 1 ë˜ëŠ” íŒ€ 2)
      const teamSelector = team === 'team1' ? '.teams-container .team:first-child' : '.teams-container .team:last-child';
      const banSlots = document.querySelectorAll(`${teamSelector} .team-ban-slots .ban-slot`);
      
      // ëª¨ë“  ìŠ¬ë¡¯ ì´ˆê¸°í™”
      banSlots.forEach(slot => {
        slot.innerHTML = '';
        slot.classList.add('empty');
      });
      
      // ë°´ëœ ì±”í”¼ì–¸ í‘œì‹œ
      bannedChampions.forEach((champion, index) => {
        if (index < banSlots.length && champion) {
          const slot = banSlots[index];
          slot.innerHTML = `<img src="/champions/${champion}.png" alt="${champion}" title="${getKoreanName(champion)}">`;
          slot.classList.remove('empty');
        }
      });
    }

    // ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” í•¨ìˆ˜
    function resetBanSlots() {
      console.log('ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™” ì‹¤í–‰');
      
      // íŒ€1 ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™”
      const team1BanSlots = document.querySelectorAll('.teams-container .team:first-child .team-ban-slots .ban-slot');
      team1BanSlots.forEach(slot => {
        slot.innerHTML = '';
        slot.classList.add('empty');
      });
      
      // íŒ€2 ë°´ ìŠ¬ë¡¯ ì´ˆê¸°í™”
      const team2BanSlots = document.querySelectorAll('.teams-container .team:last-child .team-ban-slots .ban-slot');
      team2BanSlots.forEach(slot => {
        slot.innerHTML = '';
        slot.classList.add('empty');
      });
      
      // ì¤‘ì•™ ë°´ ì„¹ì…˜ ì´ˆê¸°í™”
      const bannedChampionsContainer = document.getElementById('bannedChampions');
      if (bannedChampionsContainer) {
        bannedChampionsContainer.innerHTML = '<div class="empty-champion-list">ë°´ëœ ì±”í”¼ì–¸ì´ ì—†ìŠµë‹ˆë‹¤</div>';
      }
      
      // ìŠ¬ë¡¯ ìƒíƒœ ì ìš©ì„ ìœ„í•œ ê°•ì œ ë¦¬í”Œë¡œìš°
      void document.body.offsetHeight;
    }

    // í”Œë ˆì´ì–´ ë°´ ì„ íƒ ì¤‘ì¸ ì±”í”¼ì–¸ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸
    socket.on('player-selecting-champion', (data) => {
      // í”Œë ˆì´ì–´ê°€ ì„ íƒ ì¤‘ì¸ ì±”í”¼ì–¸ ì •ë³´ ì—…ë°ì´íŠ¸
      if (data.playerId && data.playerId !== socket.id) { // ìì‹ ì´ ì•„ë‹Œ ë‹¤ë¥¸ í”Œë ˆì´ì–´ì˜ ì •ë³´ë§Œ ì—…ë°ì´íŠ¸
        if (playerBanStatus[data.playerId]) {
          // ê°™ì€ íŒ€ì¸ì§€ í™•ì¸
          const myStatus = playerBanStatus[socket.id];
          const myTeam = myStatus ? myStatus.team : socket.team;
          const playerTeam = playerBanStatus[data.playerId].team;
          
          // ê°™ì€ íŒ€ì¸ ê²½ìš°ì—ë§Œ ì„ íƒ ì¤‘ì¸ ì±”í”¼ì–¸ í‘œì‹œ
          if (myTeam === playerTeam) {
            playerBanStatus[data.playerId].selectingChampion = data.champion;
            
            // í”Œë ˆì´ì–´ ë°´ ìƒíƒœ UI ì—…ë°ì´íŠ¸
            updatePlayerBanStatus();
            
            // ì±”í”¼ì–¸ ê·¸ë¦¬ë“œ ì—…ë°ì´íŠ¸
            renderChampionGrid();
          }
        }
      }
    });
    
    // ë°© ìƒì„± ì„±ê³µ ì‘ë‹µ ì²˜ë¦¬
    socket.on('room-created', () => {
      console.log('ë°© ìƒì„± ì„±ê³µ ì‘ë‹µ ìˆ˜ì‹ ');
      isCreatingRoom = false;
      hasJoined = true;
      localStorage.setItem('hasJoined', 'true');
      
      // ë°© ìƒì„± ì„±ê³µ ì‹œ ê²Œì„ë£¸ í‘œì‹œ
      document.getElementById('gameRoom').style.display = 'block';
      document.getElementById('resetGameBtn').disabled = false;
      document.getElementById('resetRoomBtn').disabled = false;
      
      // ì•Œë¦¼ ë©”ì‹œì§€
      Toastify({
        text: "ë°© ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!",
        duration: 2000,
        gravity: "top",
        position: "center",
        style: {
          background: "linear-gradient(to right, #00b09b, #96c93d)",
          color: "white",
          fontWeight: "bold",
          fontSize: "14px",
          padding: "12px",
          borderRadius: "5px"
        }
      }).showToast();
    });
  </script>
</body>
</html>
